2.4. Требования к показателям четвертого класса защищенности.

2.4.1. Дискреционный принцип контроля доступа.

Данные требования включают аналогичные требования пятого класса (п. 2.3.1).

Дополнительно КСЗ должен содержать механизм, претворяющий в жизнь дискреционные ПРД, как для явных действий пользователя, так и для скрытых, обеспечивая тем самым защиту объектов от НСД (т.е. от доступа, не допустимого с точки зрения заданного ПРД). Под "явными" здесь подразумеваются действия, осуществляемые с использованием системных средств - системных макрокоманд, инструкций языков высокого уровня и т.д., а под "скрытыми" - иные действия, в том числе с использованием собственных программ работы с устройствами.

Дискреционные ПРД для систем данного класса являются дополнением мандатных ПРД.

2.4.2. Мандатный принцип контроля доступа.

Для реализации этого принципа должны сопоставляться классификационные метки каждого субъекта и каждого объекта, отражающие их место в соответствующей иерархии. Посредством этих меток субъектам и объектам должны назначаться классификационные уровни (уровни уязвимости, категории секретности и т.п.), являющиеся комбинациями иерархических и неиерархических категорий. Данные метки должны служить основой мандатного принципа разграничения доступа.

КСЗ при вводе новых данных в систему должен запрашивать и получать от санкционированного пользователя классификационные метки этих данных. При санкционированном занесении в список пользователей нового субъекта должно осуществляться сопоставление ему классификационных меток. Внешние классификационные метки (субъектов, объектов) должны точно соответствовать внутренним меткам (внутри КСЗ).

КСЗ должен реализовывать мандатный принцип контроля доступа применительно ко всем объектам при явном и скрытом доступе со стороны любого из субъектов:

- субъект может читать объект, только если иерархическая классификация в классификационном уровне субъекта не меньше, чем иерархическая классификация в классификационном уровне объекта, и неиерархические категории в классификационном уровне субъекта включают в себя все иерархические категории в классификационном уровне объекта;

- субъект осуществляет запись в объект, только если классификационный уровень субъекта в иерархической классификации не больше, чем классификационный уровень объекта в иерархической классификации, и все иерархические категории в классификационном уровне субъекта включаются в неиерархические категории в классификационном уровне объекта.

Реализация мандатных ПРД должна предусматривать возможности сопровождения: изменения классификационных уровней субъектов и объектов специально выделенными субъектами.

В СВТ должен быть реализован диспетчер доступа, т.е. средство, осуществляющее перехват всех обращений субъектов к объектам, а также разграничение доступа в соответствии с заданным принципом разграничения доступа. При этом решение о санкционированности запроса на доступ должно приниматься только при одновременном разрешении его и дискреционными, и мандатными ПРД. Таким образом, должен контролироваться не только единичный акт доступа, но и потоки информации.

2.4.3. Очистка памяти.

При первоначальном назначении или при перераспределении внешней памяти КСЗ должен затруднять субъекту доступ к остаточной информации. При перераспределении оперативной памяти КСЗ должен осуществлять ее очистку.

2.4.4. Изоляция модулей.

При наличии в СВТ мультипрограммирования в КСЗ должен существовать программно-технический механизм, изолирующий программные модули одного процесса (одного субъекта), от программных модулей других процессов (других субъектов) - т.е. в оперативной памяти ЭВМ программы разных пользователей должны быть защищены друг от друга.

2.4.5. Маркировка документов.

При выводе защищаемой информации на документ в начале и конце проставляют штамп N 1 и заполняют его реквизиты в соответствии с Инструкцией N 0126-87 (п. 577).

2.4.6. Защита ввода и вывода на отчуждаемый физический носитель информации.

КСЗ должен различать каждое устройство ввода-вывода и каждый канал связи как произвольно используемые или идентифицированные ("помеченные"). При вводе с "помеченного" устройства (вывода на "помеченное" устройство) КСЗ должен обеспечивать соответствие между меткой вводимого (выводимого) объекта (классификационным уровнем) и меткой устройства. Такое же соответствие должно обеспечиваться при работе с "помеченным" каналом связи.

Изменения в назначении и разметке устройств и каналов должны осуществляться только под контролем КСЗ.

2.4.7. Сопоставление пользователя с устройством.

КСЗ должен обеспечивать вывод информации на запрошенное пользователем устройство как для произвольно используемых устройств, так и для идентифицированных (при совпадении маркировки).

Идентифицированный КСЗ должен включать в себя механизм, посредством которого санкционированный пользователь надежно сопоставляется выделенному устройству.

2.4.8. Идентификация и аутентификация.

КСЗ должен требовать от пользователей идентифицировать себя при запросах на доступ, должен проверять подлинность идентификатора субъекта - осуществлять аутентификацию. КСЗ должен располагать необходимыми данными для идентификации и аутентификации и препятствовать входу в СВТ неидентифицированного пользователя или пользователя, чья подлинность при аутентификации не подтвердилась.

КСЗ должен обладать способностью надежно связывать полученную идентификацию со всеми действиями данного пользователя.

2.4.9. Гарантии проектирования.

Проектирование КСЗ должно начинаться с построения модели защиты, содержащей:

- непротиворечивые ПРД;

- непротиворечивые правила изменения ПРД;

- правила работы с устройствами ввода и вывода информации и каналами связи.

2.4.10. Регистрация.

Данные требования включают аналогичные требования пятого класса защищенности (п.2.3.5). Дополнительно должна быть предусмотрена регистрация всех попыток доступа, всех действий оператора и выделенных пользователей (администраторов защиты и т.п.).

2.4.11. Целостность КСЗ.

В СВТ четвертого класса защищенности должен осуществляться периодический контроль за целостностью КСЗ.

Программы КСЗ должны выполняться в отдельной части оперативной памяти.

2.4.12. Тестирование.

В четвертом классе защищенности должны тестироваться:

- реализация ПРД (перехват запросов на доступ, правильное распознавание санкционированных и несанкционированных запросов в соответствии с дискреционными и мандатными правилами, верное сопоставление меток субъектов и объектов, запрос меток вновь вводимой информации, средства защиты механизма разграничения доступа, санкционированное изменение ПРД);

- невозможность присвоения субъектом себе новых прав;

- очистка оперативной и внешней памяти;

- работа механизма изоляции процессов в оперативной памяти;

- маркировка документов;

- защита вода и вывода информации на отчуждаемый физический носитель и сопоставление пользователя с устройством;

- идентификация и аутентификация, а также их средства защиты;

- запрет на доступ несанкционированного пользователя;

- работа механизма, осуществляющего контроль за целостностью СВТ;

- регистрация событий, описанных в п. 2.4.10, средства защиты регистрационной информации и возможность санкционированного ознакомления с этой информацией.

2.4.13. Руководство для пользователя.

Данное требование совпадает с аналогичным требованием шестого (п. 2.2.4) и пятого (п. 2.3.8) классов.

2.4.14. Руководство по КСЗ.

Данные требования полностью совпадают с аналогичными требованиями пятого класса (п. 2.3.9).

2.4.15. Тестовая документация.

Должно быть представлено описание тестов и испытаний, которым подвергалось СВТ (в соответствии с п. 2.4.12) и результатов тестирования.

2.4.16. Конструкторская (проектная) документация.

Должна содержать:

- общее описание принципов работы СВТ;

- общую схему КСЗ;

- описание внешних интерфейсов КСЗ и интерфейсов модулей КСЗ;

- описание модели защиты;

- описание диспетчера доступа;

- описание механизма контроля целостности КСЗ;

- описание механизма очистки памяти;

- описание механизма изоляции программ в оперативной памяти;

- описание средств защиты ввода и вывода на отчуждаемый физический носитель информации и сопоставления пользователя с устройством;

- описание механизма идентификации и аутентификации;

- описание средств регистрации.

2.5. Требования к показателям третьего класса защищенности

2.5.1. Дискреционный принцип контроля доступа.

Данные требования полностью совпадают с требованиями пятого (п. 2.3.1) и четвертого классов (п. 2.4.1).

2.5.2. Мандатный принцип контроля доступа.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.2).

2.5.3. Очистка памяти.

Для СВТ третьего класса защищенности КСЗ должен осуществлять очистку оперативной и внешней памяти. Очистка должна производиться путем записи маскирующей информации в память при ее освобождении (перераспределении).

2.5.4. Изоляция модулей.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.4).

2.5.5. Маркировка документов.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.5).

2.5.6. Защита ввода и вывода на отчуждаемый физический носитель информации.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.6).

2.5.7. Сопоставление пользователя с устройством.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.7).

2.5.8. Идентификация и аутентификация.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.8).

2.5.9. Гарантии проектирования.

На начальном этапе проектирования КСЗ должна строиться модель защиты, задающая принцип разграничения доступа и механизм управления доступом. Эта модель должна содержать:

- непротиворечивые правила изменения ПРД;

- правила работы с устройствами ввода и вывода;

- формальную модель механизма управления доступом.

Должна предлагаться высокоуровневая спецификация части КСЗ, реализующего механизм управления доступом и его интерфейсов. Эта спецификация должна быть верифицирована на соответствие заданных принципов разграничения доступа.

2.5.10. Регистрация.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.10).

2.5.11. Взаимодействие пользователя с КСЗ.

Для обеспечения возможности изучения, анализа, верификации и модификации КСЗ должен быть хорошо структурирован, его структура должна быть модульной и четко определенной. Интерфейс пользователя и КСЗ должен быть определен (вход в систему, запросы пользователей и КСЗ и т.п.). Должна быть обеспечена надежность такого интерфейса. Каждый интерфейс пользователя и КСЗ должен быть логически изолирован от других таких же интерфейсов.

2.5.12. Надежное восстановление

Процедуры восстановления после сбоев и отказов оборудования должны обеспечивать полное восстановление свойств КСЗ.

2.5.13. Целостность КСЗ.

Необходимо осуществлять периодический контроль за целостностью КСЗ.

Программы должны выполняться в отдельной части оперативной памяти. Это требование должно подвергаться верификации.

2.5.14. Тестирование.

СВТ должны подвергаться такому же тестированию, что и СВТ четвертого класса (п. 2.4.12).

Дополнительно должны тестироваться:

- очистка памяти (п. 2.5.3);

- работа механизма надежного восстановления.

2.5.15. Руководство для пользователя.

Данные требования полностью совпадают с аналогичным требованием четвертого класса (п. 2.4.13).

2.5.16. Руководство по КСЗ.

Документ адресован администратору защиты и должен содержать:

- описание контролируемых функций;

- руководство по генерации КСЗ;

- описание старта СВТ, процедур проверки правильности старта, процедур работы со средствами регистрации;

- руководство по средствам надежного восстановления.

2.5.17. Тестовая документация

В документации должно быть представлено описание тестов и испытаний, которым подвергалось СВТ (п. 2.5.14), а также результатов тестирования.

2.5.18. Конструкторская (проектная) документация.

Требуется такая же документация, что и для СВТ четвертого класса (п.2.4.16). Дополнительно необходимы:

- высокоуровневая спецификация КСЗ и его интерфейсов;

- верификация соответствия высокоуровневой спецификации КСЗ модели защиты.


########################

## Сравнительный анализ требований к 3 и 4 классам защищенности

## Общие требования

В обоих классах есть общие требования, такие как:
- **Дискреционный принцип контроля доступа:** Требования полностью совпадают.
- **Мандатный принцип контроля доступа:** Требования полностью совпадают.
- **Изоляция модулей:** Требования полностью совпадают.
- **Маркировка документов:** Требования полностью совпадают.
- **Защита ввода и вывода на отчуждаемый физический носитель информации:** Требования полностью совпадают.
- **Сопоставление пользователя с устройством:** Требования полностью совпадают.
- **Идентификация и аутентификация:** Требования полностью совпадают.
- **Регистрация:** Требования полностью совпадают.
- **Руководство для пользователя:** Требования полностью совпадают.
- **Конструкторская (проектная) документация:** Требования к общей структуре документации совпадают.
## Различия в требованиях

1. **Очистка памяти:**    
    - **4 класс:** Требуется затруднить доступ к остаточной информации при первоначальном назначении или перераспределении внешней памяти. При перераспределении оперативной памяти требуется её очистка.
    - **3 класс:** Требуется очистка как оперативной, так и внешней памяти путем записи маскирующей информации при ее освобождении.

2. **Гарантии проектирования:**
    - **4 класс:** Требуется построение модели защиты с непротиворечивыми правилами, а также правила работы с устройствами ввода и вывода информации и каналами связи.
    - **3 класс:** Требуется построение модели защиты, задающей принцип разграничения доступа и механизм управления доступом, а также формальную модель механизма управления доступом. Дополнительно требуется высокоуровневая спецификация части КСЗ, реализующего механизм управления доступом, и её верификация на соответствие заданным принципам разграничения доступа.

3. **Взаимодействие пользователя с КСЗ (только для 3 класса):**
    - **3 класс:** Требуется хорошо структурированный и модульный КСЗ с четко определенным интерфейсом пользователя и надежной логической изоляцией каждого интерфейса.
        
4. **Надежное восстановление (только для 3 класса):**
    - **3 класс:** Процедуры восстановления после сбоев и отказов оборудования должны обеспечивать полное восстановление свойств КСЗ.
        
5. **Целостность КСЗ:**
    - **4 класс:** Требуется периодический контроль за целостностью КСЗ.
    - **3 класс:** Требуется периодический контроль за целостностью КСЗ и верификация требования о выполнении программ в отдельной части оперативной памяти.
        
6. **Тестирование:**
    - **4 класс:** Определен перечень аспектов, подлежащих тестированию (реализация ПРД, очистка памяти, изоляция процессов и т.д.).
    - **3 класс:** Требуется такое же тестирование, как и для 4 класса, плюс дополнительное тестирование очистки памяти и работы механизма надежного восстановления.
        
7. **Руководство по КСЗ:**
    - **4 класс:** Требования полностью совпадают с требованиями 5 класса.
    - **3 класс:** Документ адресован администратору защиты и должен содержать: описание контролируемых функций; руководство по генерации КСЗ; описание старта СВТ, процедур проверки правильности старта, процедур работы со средствами регистрации; руководство по средствам надежного восстановления.
        
8. **Конструкторская (проектная) документация:**
    - **4 класс:** Требуется общее описание принципов работы СВТ, общая схема КСЗ, описание интерфейсов КСЗ, описание модели защиты, диспетчера доступа, механизмов контроля целостности и очистки памяти, изоляции программ, защиты ввода-вывода и идентификации-аутентификации, а также средств регистрации.
    - **3 класс:** Требуется такая же документация, как и для 4 класса, плюс высокоуровневая спецификация КСЗ и его интерфейсов, а также верификация соответствия этой спецификации модели защиты.
