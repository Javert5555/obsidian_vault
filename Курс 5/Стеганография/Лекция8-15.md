# Лекция 8

## Стеганосистемы с секретным ключом

По принципу Керхгофса, безопасность системы должна базироваться на определенном фрагменте секретной информации — ключе, который (как правило, предварительно) разделяется между авторизованными лицами. Отправитель, встраивая секретное сообщение в избранный контейнер с, использует стеганоключ k. Если получатель знает данный ключ, то он может извлечь из контейнера скрытое сообщение. Без знания ключа любое постороннее лицо этого сделать не сможет.

Стеганосистемой с секретным ключом называют совокупность `E = (C, M, K, S^K, E, D)`, где С — множество контейнеров-оригиналов; М — множество секретных сообщений, причем `|M| <= |C|`; S^K - множество контейнеров - результатов, причем `sim(C, S^K) → 1`; К - множество секретных стеганоключей; `E: C x M x K → S^K` и `D: S^K × К → М` — функции прямого и обратного стеганопреобразования со свойством `D[E(c, m, k), k] = m` для любых `m є М`, `с є С` и `k є K`.

Данный тип стеганосистем предполагает наличие безопасного (защищенного) канала обмена стеганоключами.

Иногда ключ k вычисляют с помощью секретной хэш-функции, используя некоторые характерные черты контейнера. Если стеганопреобразование Е не изменяет в окончательной стеганограмме выбранные особенности контейнера, то получатель также сможет вычислить стеганоключ (хотя и в этом случае защита будет зависеть от секретности хэш-функции, и, таким образом, опять нарушается принцип Керхгофса). Очевидно, что для достижения адекватного уровня защиты такую особенность в контейнере необходимо выбирать достаточно внимательно.

В некоторых алгоритмах во время извлечения скрытой информации дополнительно необходимы сведения о первичном (пустом) контейнере или некоторые другие данные, отсутствующие в стеганограмме. Такие системы представляют ограниченный интерес, поскольку они требуют передачи изначального вида контейнера, что эквивалентно традиционной задаче обмена ключами. Подобные алгоритмы могут быть отмечены как отдельный случай стеганосистем с секретным ключом, у которых `К = С` или `К = С × К'`, где `К'` — множество дополнительных наборов секретных ключей.

## Стеганосистемы с открытым ключом

Стеганография с открытым ключом опирается на достижения криптографии последних 30 лет. Стеганографические системы с открытым ключом не имеют потребности в дополнительном канале ключевого обмена. Для их функционирования необходимо иметь два стеганоключа; один секретный, который необходимо хранить в тайне, а другой — открытый, который может храниться в доступном для всех месте. При этом открытый ключ используется для встраивания сообщения, а секретный — для его извлечения.

Стеганосистемой с открытым ключом называют совокупность `Z = (C, M, K, S^K, E, D)`, где С — множество контейнеров-оригиналов; М - множество секретных сообщений, `|М| ≤ |C|`; S^K— множество контейнеров- результатов; `sim(C, S^K) → 1`; `K = (k_o, k_c)` — множество пар стеганоключей (открытый ключ ко используется для скрытия информации, а секретный ключ k_c — для ее извлечения); `E: C × M × ko → S^K` и `D: S^K` x `k_c → М` — функции прямого и обратного стеганопреобразования со свойством `D[E(c, m, k_o). k_c] = m` для любых `m є М`, `с є С` и `k_o, k_c є K`.

Следует отметить, что стеганоключ не шифрует данные, а скрывает место их встраивания в контейнере. Скрытые данные могут быть дополнительно зашифрованы классическим методом но этот вопрос не касается непосредственно стеганографии.

Стеганосистемы с открытым ключом используют тот факт, что функция извлечения скрытых данных D может быть применена к любому контейнеру, независимо от того, находится в нем скрытое сообщение или нет.

Если скрытое сообщение отсутствует, то на выходе будет получена некоторая случайная последовательность.

Если эта последовательность статистически не отличается от шифртекста криптосистемы с открытым ключом, тогда в безопасной стеганосистеме можно скрывать полученный таким образом шифртекст, а не открытый текст.

## Смешанные стеганосистемы

На практике преимущество отдается бесключевым стеганосистемам, хотя последние могут быть раскрыты в случае, если нарушитель узнает о методе стегано-преобразования, который был при этом использован.

В связи с этим в бесключевых системах часто используют особенности криптографических систем с открытым и/или секретным ключом.

Учитывая большое разнообразие форматов, которые могут иметь скрываемые сообщения и контейнеры (текст, звук или видео, которые, в свою очередь, также делятся на подформаты), представляется целесообразным предварительное преобразование сообщения в удобный для встраивания и оптимальный с точки зрения скрытости в заданном контейнере формат :

Другими словами, необходимо учитывать как особенности встраиваемого сообщения, так и особенности контейнера, в который планируется его ввести.

Произвольность функции U ограничивается требованиями устойчивости к разного рода влияниям на полученный контейнер-результат. Кроме того, функция U является составной: `U =T • G` где `G: M x K → Z`; `T: C x Z → W`.

Функция G может быть реализована, например, с помощью криптографического безопасного генератора ПСП с К в качестве изначального значения. Для повышения устойчивости скрытого сообщения могут использоваться помехоустойчивые коды, например, коды Хемминга, Голея, сверточные коды.

Оператор Т модифицирует кодовые слова Z с учетом формата контейнера, в результате чего получается оптимальное для встраивания сообщение. Функция Т должна быть выбрана таким образом, чтобы контейнер-оригинал С, контейнер-результат S и модифицированный в предусмотренных границах контейнер-результат S̃ порождали одно и то же оптимальное для встраивания сообщение: `T: C x Z = T: S x Z = T: S̃ x Z = → W`

Процесс встраивания сообщения W в контейнер-оригинал С при этом можно описать как   суперпозицию сигналов: `E: C x V x W → S`; где V — маска встраивания сообщений, которая учитывает, например, характеристики зрительной системы среднестатистического человека и служит для уменьшения заметности этих сообщений

# Лекция 9

Использование бесключевых стеганосистем является нецелесообразным, так как базируется только на секретности стеганографических преобразований.

Преимущественно использование протокола с открытым ключом.

## Самостоятельна обработка
Анализ стеганографических программ включает изучения из возможностей, принципов работы, преимуществ и недостатков. Программы, которые необходимо проанализировать.

- OutGuess - Сокрытие данных в JPEG-изображение. Возможность контроля  вносимых 'Статических искажений', большая стойкость к атакам. Ориентирована на работу в Unix-подобных ОС.
- JSTEG - нестойкость к атакам пассивных противников, возможность автоматического детектирования наличия скрытого сообщения. Ориентирована на ОС MS-DOS.
- JPHS Gifshuffle - Сокрытие данных в графических файлах в формате Gif. Сокрытие инф. посредством изменения  порядка цветов в палитре. Возможность предварительного сжатия или шифрования скрываемого сообщения.
- Hide-and-Seek - Сокрытие информации путём замены младших битов цветовых индексов точек изображения. Использует алгоритмы шифрования "Blowfish", осуществляет случайный выбор точек хранения. Ориентирована на ОС MS-DOS.
- Steganos - Сокрытие в граф. файлах BMP, DIP, VOC, WAV, ASCII. Сокрытие информации путем замены младших бит элементов контейнера. Возможность предварительного шифрования скрываемого сообщения. Ориентировано на ОС MS-DOS
- DC-Stegano. Сокрытие данных в графических файлах в формате РСХ. Сокрытие посредством замены младших битов ЦВЗ индексов точек изображения. Отсутствие стегоключа, строго заданный размер изображения контейнера

# Лекция 10
## Анализ угроз и оценка устойчивости стеганографической системы

### Анализ угроз и оценка устойчивости системы стеганографической защиты информации

Для каждой из задач цифровой стеганографии необходимо определенное соотношение устойчивости скрытого сообщения к внешним влияниям и размера скрытого сообщения. В большинстве случаев имеет место зависимость надежности системы от объема встраиваемого сообщения

![[Pasted image 20250407162326.png]]

Взаимосвязь между надежностью стеганосистемы и объемом встраиваемого сообщения при неизменном размере контейнера

Таким образом, в зависимости от выбранных целей, можно определить необходимое соотношение надежности и объема встраиваемого сообщения в стеганосистеме, что приводит к использованию разных методов стеганографии

**_Стегоанализ_** - оценки перехваченного контейнера на предмет наличия в нем скрытого сообщения. Встраивание скрытого сообщения приводит к изменению свойств контейнера (ухудшение характеристик) - это может указывать на встроенное сообщение и приведёт к тому, что идея стеганографии не будет выполнена.

**_Основная цель стеганоанализа_** - моделирование стеганографических систем и их исследование для получения качественных и количественных оценок надежности использования стеганопреобразования, а также построение методов выявления скрываемой в контейнере информации, ее модификации или разрушения.

Стеганосистемы делятся по уровню обеспечения секретности на теоретически устойчивые, практически устойчивые и неустойчивые системы.
- **_Теоретически устойчивая_** (абсолютно надежная) стеганосистема скрывает информацию только в тех фрагментах контейнера, значение элементов которых не превышает уровень шумов или ошибок квантования, и при этом теоретически доказано, что невозможно создать стеганоаналитический метод выявления скрытой информации.
- **_Практически устойчивая стеганосистема_** так изменяет фрагменты контейнера, что их можно выявить, но при этом известно, что на данный момент необходимые стеганоаналитические методы у нарушителя отсутствуют или пока что не разработаны.

**_Неустойчивая стеганосистема_** скрывает информацию таким образом, что существующими стеганоаналитическими средствами ее можно выявить.

Стеганографический анализ обнаруживает уязвимые места стеганографического преобразования и улучшает его так, чтобы все изменения, внесенные в контейнер, оказались бы в области теоретической или, по крайней мере, практической неразличимости.

![[Pasted image 20250407165151.png]]


Соотношение методов стеганозащиты и стеганоанализа:
- а - теоретически устойчивая стегано система;
- б - практически устойчивая стегано система;
- в - неустойчивая стегано система

![[Pasted image 20250407165306.png]] - область практической неразличимости, в которой изменения контейнера не распознаются существующими у нарушителя аналитическими методами;

![[Pasted image 20250407165329.png]] - область теоретической неразличимости, в которой скрытые элементы практически не могут быть распознаны, поскольку находятся ниже уровня шумов и ошибок квантования;

![[Pasted image 20250407165349.png]] - область защиты стеганографической системы.

Нарушитель может быть:
- пассивный - способен только обнаружить факт наличия стеганоканала и узнать о содержании сообщения. Возможность "прочитать" сообщение после его обнаружения, зависит от устойчивости системы.
- активный - способен не только обнаружить стеганоканал и сообщение, но и удалить или разрушить скрытое сообщение.
- злонамеренный - наиболее опасный, способен не только разрушать, но и создавать фальшивые стеганограммы (дезинформацию).

Для осуществления угроз нарушитель применяет атаки.

**_Чтобы процесс стеганоанализа был успешен необходимо:_**
- наличие стеганосредства для анализа, используемого для скрытия сообщения;
- наличие возможности восстановления используемых в системе алгоритмов (стеганографических и криптографических); выполнение их экспертного анализа и разработки алгоритмов определения ключей;
- наличие вычислительных ресурсов необходимой мощности для проведения стеганоанализа
- поддержание на высоком уровне необходимых теоретических и практических знаний.

Стеганосистема считается взломанной, если нарушителю удалось, хотя бы, доказать существование скрытого сообщения в перехваченном контейнере.

Нарушитель способен осуществлять любые типы атак и имеет неограниченные вычислительные возможности, если ему не удается подтвердить гипотезу о том, что в контейнере скрыто секретное сообщение, то стеганографическая система считается устойчивой.

Выделяют несколько этапов взлома стеганографической системы:
- Обнаружение факта присутствия скрытой информации.
- Извлечение скрытого сообщения.
- Видоизменение (модификация) скрытой информации
- Запрет на выполнение любой пересылки информации, в том числе скрытой
Первые два этапа являются пассивными атаками, а последние - активными.

Из криптоанализа можно выделить следующие атаки на шифрованные сообщения :
- атака с использованием только шифртекста;
- атака с использованнем открытого текста;
- атака с использованием выбранного открытого текста;
- адаптивная атака с использованием открытого текста;
- атака с использованием выбранного шифртекста.

Аналогично можно выделить следующие типы атак на стеганосистемы:
- **_Атака по известному заполненному контейнеру._** У злоумышленника есть один или несколько заполненных контейнеров (одинаковым методом). Его задачей является нахождение стеганоканала, и также извлечение скрытого сообщения или ключа.
- **_Атака по известному встроенному сообщению._** В основном используется для систем зашиты интеллектуальной собственности, например, когда ЦВЗ - известный логотип. Задана злоумышленника, в таком случае, - получение ключа. Задача является практически неразрешимой, когда заполненный контейнер, соответствующий скрытому сообщению, неизвестен.
- **_Атака на основе выбранного скрытого сообщения._** Злоумышленник может предлагать свои сообщения для передачи и изучать полученные заполненные контейнеры.
- **_Адаптивная атака на основе выбранного скрытого сообщения._** Является частным случаем атаки на основе выбранного скрытого сообщения. Злоумышленник может выбирать сообщения для передачи адаптивно, в зависимости от предыдущих результатов анализа заполненных контейнеров.
- **_Атака на основе выбранного заполненного контейнера._** Обычно используется для систем ЦВЗ Злоумышленник имеет детектор заполненных контейнеров по типу «черного ящика» и несколько заполненных контейнеров.

Исследуя результаты прохождения заполненных контейнеров через детектор, т.е. скрытые сообщения, мано выявить ключ.

- **_Атака на основе известного пустого контейнера._** Если злоумышленник имеет пустой контейнер, то сравнивая его с предположительно заполненным, может выявить факт наличия стеганоканала. Этот случай является довольно простым, но задача усложняется, если пустой контейнер имеет некие деформации (например, добавление шума). Тогда можно рассчитывать на построение стойкой стеганосистемы.
- **_Атака на основе выбранного пустого контейнера._** Злоумышленник имеет возможность заставить отправителя использовать, заранее выбранный им, пустой контейнер, в котором будет легко выявить скрытое сообщение.
- **_Атака по известной математической модели контейнера._** Злоумышленник ищет различия между подозреваемым заполненным контейнером и его известной модели. Например, биты в середине определенной части изображения являются коррелированными, тогда отсутствие такой корреляции служит сигналом о наличии скрытого сообщения. В таком случае, задачей отправителя является соблюдение отсутствия нарушений статистики контейнера.

Также вышеперечисленные атаки могут быть скомбинированы. Чем больше злоумышленник знает о стеганосистеме тем более эффективной будет атака.

Безопасность стеганосистем, как и криптографических систем, описывается и оценивается их стойкостью (стеганографической стойкостью или стеганостойкостью).

**_Стеганостойкость_** - это способность стеганосистем скрывать факт передачи скрытого сообщения, способность противостоять попыткам злоумышленника разрушить, исказить, удалить скрываемое сообщение, а также способность подтвердить или опровергнуть подлинность скрытого сообщения.

Стеганостойкость можно разделить на:
- стойкость к обнаружению факта передачи (существования) скрываемого сообщения;
- стойкость к извлечению скрываемого сообщения;
- стойкость к навязыванию ложных сообщений по каналу скрытой связи (имитостойкость) - способность стеганосистемы находить и отвергать скомпрометированные злоумышленниками контейнеры;
- стойкость к восстановлению секретного ключа стеганосистемы - способность стегано системы противо тоять попыткам нарушителей вычислить секретный ключ.

# Лекция 11

## Метод замена наименее значащего бита Метод Куттера-Джордана-Боссена

**Метод наименее значимых битов (LSB - Least Significant Bit)**: Замена наименее значимых битов пикселей данными сообщения.
Преимущества: Простота реализации. 
Недостатки: Относительно низкая устойчивость к сжатию и атакам. Может быть обнаружен с помощью стеганоанализа. 
Пример: Если бит сообщения равен 1, а наименее значимый бит пикселя равен 0, бит пикселя заменяется на 1. Аналогично для бита 0.

Суть метода замена наименее значащего бита ( Least Significant Bits - LSB) заключается в сокрытии информации путем изменения последних битов изображения, кодирующих цвет на биты скрываемого сообщения.

Рассчитаем пропускную способность метода. Если отбросить в расчетах, обычно незначительную относительно размера изображения, служебную информацию в начале файла, то мы имеем возможность скрытно передать сообщение размером в 1/8 размера контейнера ("размазанную" по последним битам в каждом байте матрицы цветов пикселей) или же размером в 1/4 контейнера (соответственно при использовании 2 последних битов в байтах).

>[!warning] Важная информация (лучше запомнить)
В формате `.bmp` изображение хранится, как матрица значений оттенков цвета для каждой точки, если каждая из компонентов пространства RGB (канал цвета) хранится в одном байте, она может принимать значения от 0 до 255, что соответствует 24-битной глубине цвета.

![[Pasted image 20250414164522.png]]

Т.е. метод состоит в простой замене на бит внедряемого сообщения, будь то 0 или 1.

Изменения значения пикселей при последовательном внедрении в них сообщения 1001:

51 80 121 62 заменяет на 51 80 120 63

Пример:
![[Pasted image 20250414170435.png]]

Небольшая модификация данной стеганографической техники позволяет исп. для встраивания сообщения два или более младших битов. Это даёт возможность увеличить объём скрытой информации в контейнере, но скрытость сильно снижается , что облегчает обнаружение стеганографии.

Достоинства и недостатки:

Методы LSB являются неустойчивыми ко всем видам атак и могут быть использованы только при отсутствии шума в канале передачи данных.

Обнаружение LSB-кодированного стего осуществляется по аномальным характеристикам распределения значений диапазона младших битов отсчётов цифрового сигнала.

# Лекция 12
**Метод Куттера-Джордана-Боссена** - стеганографический метод, осуществляющий внедрение ЦВЗ в изображение. Метод был представлен Мартином Куттером, Фредериком Джорданом и Фрэнком Боссеном в апреле 1998 г., как алгоритм встраивания синего цвета изображения, имеющего RGB-кодирование, поскольку к синему цвету зрительная система человека является наименее чувствительной.

**Метод Куттера-Джордана-Боссена** относится к классу алгоритмов, осуществляющих скрытие данных в пространственной области.

В алгоритмах этого класса внедрение ЦВЗ выполняется за счёт изменения яркостной либо цветовых компонент пикселя.

В этом методе отдельные биты водяного знака многократно внедряются в изображение путём изменения значения синего канала в пикселе. Это изменение пропорционально яркостной компоненте пикселя и может принимать как положительные, так и отрицательные значения в зависимости от значения встраиваемого бита водяного знака.

Основными свойствами, которыми должен обладать ЦВЗ - это неразличимость для человеческого глаза и устойчивость к различным искажениям и изменениям изображения. 

**Метод Куттера-Джордана-Боссена** удовлетворяет первому требованию за счёт встраивания битов водяного знака именно в синий канал пикселя, так как человеческий глаз наименее чувствителен именно к этому цвету.

Устойчивость к искажениям изображения обеспечивается путём многократного встраивания битов ЦВЗ в различных частях исходного изображения.

Применение этого метода показало высокую эффективность при его использовании для защиты авторских прав изображений и видеоматериалов, а также для проверки целостности изображений и QR-кодов.

## ЦВЗ: Основные понятия

**ЦВЗ** - информация, внедренная в цифровой контент (изображение, аудио, видео и т.д.) для защиты авторских прав, аутентификации, отслеживания копий и других целей.

**Встраивание ЦВЗ** — процесс добавления ЦВЗ в контент.

Извлечение ЦВЗ — процесс восстановления ЦВЗ из контента.

**Стойкость** — способность ЦВЗ выдерживать различные виды атак (обработка изображений, сжатие, геометрические преобразования и т.д.) без потери возможности извлечения.  
  
**Невидимость (незаметность)** — степень, в которой ЦВЗ заметен для человеческого восприятия. Идеальный ЦВЗ должен быть невидимым.

## Типы ЦВЗ:
  
**1. Видимые ЦВЗ** — накладываются поверх изображения и видны невооружённым глазом (например, логотип телеканала).

**2. Невидимые ЦВЗ** — встраиваются в изображение таким образом, что они незаметны для человеческого глаза, но могут быть извлечены с помощью специального программного обеспечения.

**3. Слепые ЦВЗ** — извлекаются из контента без необходимости использования исходного контента.

**4. Неслепые ЦВЗ** — требуют наличия исходного контента для извлечения ЦВЗ.

## Методы встраивания:

**1. Пространственные методы** — непосредственно изменяют значения пикселей в изображении.

**2. Частотные методы** — преобразуют изображение в частотную область (например, с помощью дискретного косинусного преобразования — DCT) и встраивают ЦВЗ в коэффициенты преобразования.

## Метод Kutter-Jordan-Bossen (KJB)

Общий принцип Метода KJB является пространственным методом встраивания невидимого водяного знака.

Он основан на следующем принципе:
1. Локальная адаптация — вместо того, чтобы встраивать ЦВЗ во все пиксели изображения, метод KJB выбирает только те пиксели, которые имеют достаточную локальную вариацию. Это позволяет минимизировать видимые искажения, вызванные встраиванием ЦВЗ.
2. Анализ локальной статистики — для выбора пикселей, в которые будет встроен ЦВЗ, метод KJB анализирует локальную статистику изображения, в частности, стандартное отклонение значений пикселей в окрестности каждого пикселя.
3. Модификация пикселей — после выбора пикселей, в которые будет встроен ЦВЗ, их значения модифицируются в соответствии с определённым правилом, которое зависит от бита ЦВЗ, который необходимо встроить.

## Алгоритм встраивания метода KJB

Алгоритм встраивания метода состоит из следующих шагов:
  
1. Разбиение изображения на блоки — изображение разбивается на неперекрывающиеся блоки размером N × N пикселей (например, 3×3 или 5×5). Размер блока определяет локальность, в которой оценивается вариация.
2. Вычисление стандартного отклонения — для каждого блока вычисляется стандартное отклонение значений пикселей (обычно яркости или одного из цветовых каналов).
3. Выбор пикселей для встраивания — блоки, стандартное отклонение которых превышает определённый порог T (заранее определённый), считаются пригодными для встраивания ЦВЗ. В каждом таком блоке выбирается один пиксель для встраивания. Часто выбирают пиксель с максимальной яркостью.
4. Встраивание бита ЦВЗ — значение выбранного пикселя модифицируется в соответствии с битом ЦВЗ, который необходимо встроить. Например, если необходимо встроить бит "1", значение пикселя увеличивается на определённую величину α, а если необходимо встроить бит "0", значение пикселя уменьшается на α.

Формула для встраивания:
I'(x, y) = I(x, y) + α * W(i), где:
- I'(x, y) — значение пикселя после встраивания ЦВЗ
- I(x, y) — значение пикселя до встраивания ЦВЗ
- α — сила ЦВЗ (параметр, определяющий степень воздействия на пиксель)
- W(i) — бит ЦВЗ (либо +1, либо -1, для представления 1 и 0 соответственно).
5. Повторение: Шаги 1-4 повторяются для каждого бита ЦВЗ.

## Алгоритм извлечения метода KJB

Состоит из следующих шагов:
1. Разбиение изображения на блоки — изображение разбивается на блоки размером N × N пикселей, как и при встраивании.

2. Вычисление стандартного отклонения — для каждого блока вычисляется стандартное отклонение значений пикселей.

3. Выбор пикселей для извлечения — блоки, стандартное отклонение которых превышает порог T, считаются пригодными для извлечения ЦВЗ. В каждом таком блоке выбирается пиксель, в который, предположительно, был встроен ЦВЗ (например, пиксель с максимальной яркостью).

4. Извлечение бита ЦВЗ — бит ЦВЗ извлекается путём сравнения значения выбранного пикселя с некоторым порогом или с соседними пикселями. В простейшем случае можно сравнить значение пикселя с его исходным значением (если известен исходный контент) или оценить изменение значения относительно соседних пикселей.

Например, можно использовать следующее правило:
W'(i) = sign(I'(x, y) - I(x, y))
где:
- W'(i) — извлечённый бит ЦВЗ.
- sign() — функция, возвращающая +1, если аргумент положительный, и -1, если аргумент отрицательный.
- I′(x, y) — значение пикселя после встраивания ЦВЗ.
- I(x, y) — значение пикселя до встраивания ЦВЗ (требуется для несlepого извлечения).  
 
 Если исходное изображение неизвестно, можно использовать адаптивные методы, основанные на анализе локальных характеристик изображения.  
  
5. Повторение: Шаги 1–4 повторяются для каждого бита ЦВЗ.

## Преимущества и недостатки метода KJB

Преимущества:  
  
1. Относительная простота реализации — алгоритм KJB достаточно прост для понимания и реализации.

2. Локальная адаптация — выбор пикселей для встраивания на основе локальной статистики позволяет минимизировать видимые искажения.

3. Неплохая стойкость к некоторым атакам — метод KJB может быть достаточно стойким к некоторым видам атак, таким как добавление шума, фильтрация и сжатие.

Недостатки:

1. Низкая стойкость к геометрическим атакам — метод KJB очень чувствителен к геометрическим преобразованиям (поворот, масштабирование, сдвиг), поскольку он основан на фиксированном местоположении пикселей.

2. Возможность визуального обнаружения — хотя метод KJB пытается минимизировать видимость ЦВЗ, при достаточно высокой силе ЦВЗ (большом значении α) ЦВЗ может быть визуально обнаружен.

3. Требуется оптимизация параметров — для достижения оптимального баланса между стойкостью и невидимостью необходимо тщательно оптимизировать параметры метода, такие как размер блока N, порог T и сила ЦВЗ α.

4. Уязвимость к коллизионным атакам — метод может быть уязвим к коллизионным атакам, когда злоумышленник пытается встроить свой ЦВЗ поверх оригинального, что может привести к неправильному извлечению оригинального ЦВЗ.


ГДЕ В КОДЕ ПРОИСХОДИТ ВСТРАИВАНИЕ ИТМЕ

## Модификация и улучшения метода KJB

Существуют различные модификации и улучшения метода KJB, направленные на повышение его стойкости и невидимости. Некоторые из них включают:

1. Использование адаптивного порога T — вместо фиксированного порога T можно использовать адаптивный порог, который зависит от локальных характеристик изображения.

2. Использование более сложных правил встраивания — вместо простого увеличения или уменьшения значения пикселя можно использовать более сложные правила встраивания, основанные на анализе соседних пикселей.

3. Использование частотных преобразований — можно комбинировать метод KJB с частотными преобразованиями, встраивая ЦВЗ в коэффициенты преобразования, выбранные на основе локальной статистики.

4. Синхронизация — для повышения стойкости к геометрическим атакам можно использовать методы синхронизации, которые позволяют восстановить ориентацию и масштаб изображения после геометрических преобразований.

Метод Куттера-Джордана-Боссена (KJB) является классическим и важным методом в области цифровых водяных знаков.  
  
Представляет собой хороший пример пространственного метода, основанного на анализе локальной статистики изображения.  
  
Хотя метод KJB имеет свои недостатки, он послужил основой для разработки многих других более совершенных методов ЦВЗ.  
  
Понимание принципов работы метода KJB является важным для любого специалиста, работающего в области защиты информации и цифровых прав.

# Лекция 13
## ОБЗОР СТЕГОАЛГОРИТМОВ ВСТРАИВАНИЯ ИНФОРМАЦИИ В ИЗОБРАЖЕНИЯ

По способу встраивания информации стегоалгоритмы делятся на:
- - линейные (аддитивные);
- -  нелинейные
- и другие.

**Алгоритмы аддитивного внедрения информации** заключаются в линейной модификации исходного изображения, а ее извлечение в декодере производится корреляционными методами.

При этом ЦВЗ обычно складывается с изображением-контейнером, либо «вплавляется» (fusion) в него.

**В нелинейных методах встраивания информации** используется скалярное, либо векторное квантование.

Среди других методов определенный интерес представляют методы, использующие идеи фрактального кодирования изображений.

В аддитивных методах внедрения ЦВЗ представляет собой последовательность чисел,  длины, которая внедряется в выбранное подмножество отсчетов исходного изображения.

Для увеличения **робастности** внедрения во многих алгоритмах применяются широкополосные сигналы.

При этом информационные биты могут быть многократно повторены, закодированы с применением корректирующего кода, либо к ним может быть применено какое-либо другое преобразование, после чего они модулируются с помощью псевдослучайной гауссовской последовательности.

Такая последовательность является хорошей моделью шума, присутствующего в реальных изображений.

_**В то же время синтетические изображения (созданные на компьютере) не содержат шумов, и в них труднее незаметно встроить такую последовательность**__**.**_

Обычно легче первоначально сгенерировать равномерно распределенную последовательность.

Известен алгоритм преобразования такой последовательности в гауссовскую (алгоритм Бокса-Мюллера).

Преобразования Бокса-Мюллера,  является псевдослучайных чисел выборки способ генерации пар независимого , стандарта, нормально распределены (ноль ожидания , блок дисперсии ) случайных чисел, учитывая источник равномерно распределенных случайные числа.

Метод был впервые упомянут в 1934 году.

Выражается в двух формах –основная форма принимает два образца из равномерного распределения на интервале [0, 1], и отображает их на две стандартных, нормально распределенных выборки. Полярная форма принимает два образца из другого интервала, [-1, +1], и отображает их на два нормально распределенных образцы без использования синусоидального или косинуса.

![[Pasted image 20250428161118.png]]
Рис.1 -  Визуализация Box-Мюллера преобразования

Основным недостатком этого метода является то, что само изображение в этом случае рассматривается, как шумовой сигнал.

Существует гибридный подход, когда часть информации об исходном изображении доступно входе извлечения информации, но неизвестно собственно исходное изображение.

**Корреляционный метод** позволяет только обнаружить наличие или отсутствие ЦВЗ.
Для получения же всех информационных битов нужно протестировать все возможные последовательности, что является крайне вычислительно сложной задачей.

Наиболее ярким представителем алгоритмов внедрения ЦВЗ на основе использования широкополосных сигналов является _**алгоритм Кокса.**_
В данном алгоритме в блок размером 8х8 осуществляется встраивание 1 бита ЦВЗ. Описано две реализации алгоритма: псевдослучайно могут выбираться два или три коэффициента ДКП. Рассмотрим вариацию алгоритма с двумя выбираемыми коэффициентами. Встраивание информации осуществляется следующим образом: для передачи бита 0 добиваются того, чтобы разность абсолютных значений коэффициентов была бы больше некоторой положительной величины, а для передачи бита 1 эта разность делается меньше некоторой отрицательной величины:

![[Pasted image 20250428161304.png]]

ЦВЗ представляет собой последовательность псевдослучайных чисел, распределенных по гауссовскому закону, длиной 1000 чисел.

Достоинством алгоритма является то, что благодаря выбору наиболее значимых коэффициентов водяной знак является более робастным при сжатии и других видах обработки сигнала.

Вместе с тем алгоритм уязвим для атак.

### Обзор алгоритмов на основе слияния ЦВЗ и контейнера

Если вместо последовательности псевдослучайных чисел в изображение встраивается другое изображение (например, логотип фирмы), то соответствующие алгоритмы внедрения называются алгоритмами слияния.

Размер внедряемого сообщения намного меньше размера исходного изображения.
Перед встраиванием оно может быть зашифровано или преобразовано каким-нибудь иным образом.

У таких алгоритмов есть два преимущества.

Во-первых, можно допустить некоторое искажение скрытого сообщения.

Во-вторых, наличие внедренного логотипа является более убедительным доказательством прав собственности, чем наличие некоторого псевдослучайного числа.

### А29   Метод блочного скрытия

Метод блочного скрытия — это еще один подход к реализации метода замены и заключается в следующем. Изображение-оригинал разбивается на непересекающиеся блоки произвольной конфигурации, для каждого из которых вычисляется бит четности. В каждом блоке выполняется скрытие одного секретного бита.  Встраивание 1 бита происходит в 1 блок контейнера. Низкая устойчивость к искажениям. Низкая пропускная способность. Высокая устойчивость к детектированию и извлечению сообщения. Высокое быстродействие.

В алгоритме внедряется черно-белое изображение (логотип), размером до 25 % от размеров исходного изображения.

Перед встраиванием выполняется одноуровневая декомпозиция как исходного изображения, так и эмблемы с применением фильтров Хаара (определяется посредством вычитания среднего значения области темных пикселей из среднего значения области светлых пикселей). Вейвлет-коэффициенты исходного изображения - логотип. Модификации подвергаются все коэффициенты преобразования

![[Pasted image 20250428161844.png]]
Рис. Схема встраивания ЦВЗ

Вначале коэффициенты каждого поддиапазона, как исходного изображения, так и логотипа представляются 24 битами (из которых один бит отводится на знак). Так как размер логотипа в 4 раза меньше исходного изображения, то необходимо увеличить количество его коэффициентов.    

Для этого выполняются следующие действия.
1) Обозначим, через А, В, и С соответственно, старший, средний и младший байты 24-битного представления логотипа. На рис. показано формирование трех 24-битных чисел А, В и С. 
2) Старший байт каждого из этих чисел представляет собой соответственно А, В, или С, два других байта заполняются нулями.
3) Затем формируется расширенный вчетверо блок коэффициентов логотипа.
4) После чего он поэлементно складывается с 24-битной версией исходного Изображения

Данный алгоритм позволяет скрыть довольно большой объем данных в исходном изображении: до четверти от размеров исходного изображения

### А30

Исходное и внедряемое изображения подвергаются вейвлет-преобразованию (Вейвлет – преобразование сигналов является обобщением спектрального анализа, типичный представитель которого – классическое преобразование Фурье).

Для встраивания используются все коэффициенты детальных поддиапазонов. Множество этих коэффициентов разбивается на неперекрывающиеся блоки.

Блоки обозначают местоположение коэффициента и уровень разрешения. Водяной знак прибавляется к элементам исходного изображения по формуле:
![[Pasted image 20250428162224.png]]
где S — коэффициент масштаба, вычисляемый по формуле
![[Pasted image 20250428162247.png]]

C(u,v) — взвешивающая матрица, определяющая частотную чувствительность системы зрения человека, Т — оператор ДПФ (Дискретное преобразование Фурье ).

Таким образом, алгоритм использует довольно сложную модель человеческого зрения.

Для обнаружения в детекторе может быть использовано как вычисление корреляционной функции, так и визуальное сравнение.

### Стеганографические методы на основе квантования

#### Принципы встраивания информации с использованием квантования. Дизеризованные квантователи.

Под квантованием понимается процесс сопоставления большого (возможно и бесконечного) множества значений с некоторым конечным множеством чисел. При этом происходит уменьшение объема информации за счет ее искажения.

Квантование находит применение в алгоритмах сжатия с потерями. Различают скалярное и векторное квантование. При векторном квантовании, в отличие от скалярного, происходит отображение не отдельно взятого отсчета, а их совокупности (вектора).

_**Из теории информации известно, что векторное квантование эффективнее скалярного по степени сжатия, обладая большей сложностью.**_

В кодере квантователя вся область значений исходного множества делится на интервалы, и в каждом интервале выбирается число его представляющее. Это число есть кодовое слово квантователя и обычно бывает центром интервала квантования. Множество кодовых слов называется _**книгой квантователя**_. Все значения, попавшие в данный интервал, заменяются в кодере на соответствующее кодовое слово.

В декодере принятому числу сопоставляется некоторое значение.

Интервал квантования обычно называют _**шагом квантователя**_.

Встраивание информации с применением квантования относится к нелинейным методам.

Пропускная способность которой эквивалентна пропускной способности стегосистемы, имеющей на приеме исходный сигнал. При этом делается предположение о гауссовском характере исходного сигнала.

Наиболее предпочтительно внедрение информации в спектральную область изображения.

Если при этом используются линейные методы, то встраивание ЦВЗ производят в средние полосы частот.

Это объясняется тем, что энергия изображения сосредоточена, в основном, в низкочастотной (НЧ) области.

Следовательно, в детекторе ЦВЗ в этой области наблюдается сильный шум самого сигнала.

В высокочастотных (ВЧ) областях большую величину имеет шум обработки, например, сжатия.

В отличие от линейных, нелинейные схемы встраивания информации могут использовать НЧ области, так как мощность внедряемого ЦВЗ не зависит от амплитуды коэффициентов.

Это объясняется тем, что в нелинейных алгоритмах скрытия не используется корреляционный детектор, коэффициенты малой и большой амплитуды обрабатываются одинаково.

Дизеризованный квантователь может применяться и в развитии техники расширения спектра сигнала в стеганографии. Изменение обычного метода встраивания с расширением спектра заключается в простой замене сложения на операцию квантования.

![[Pasted image 20250428162808.png]]
Рис. Модель «слепой» стегосистемы

На рисунке показано, как может быть построена подобная «слепая» стегосистема, пропускная способность которой эквивалентна пропускной способности стегосистемы, имеющей на приеме исходный сигнал. При этом делается предположение о гауссовском характере исходного сигнала.

### СКРЫТИЕ ДАННЫХ В АУДИОСИГНАЛАХ

Требования, которые могут быть предъявлены к стегосистемам, применяемым для встраивания информации в аудиосигналы:
- скрываемая информация должна быть стойкой к наличию различных окрашенных шумов, сжатию с потерями, фильтрованию, аналогово-цифровому и цифро-аналоговому преобразованиям;
- скрываемая информация не должна вносить в сигнал искажения, воспринимаемые системой слуха человека;
- попытка удаления скрываемой информации должна приводить к заметному повреждению контейнера (для ЦВЗ);
- скрываемая информация не должна вносить заметных изменений в статистику контейнера;

Для внедрения скрываемой информации в аудиосигналы можно использовать методы, применимые в других видах стеганографии.

Например, можно внедрять информацию, замещая наименее значимые биты (все или некоторые). Или можно строить стегосистемы, основываясь на особенностях аудиосигналов и системы слуха человека Систему слуха человека можно представить, как анализатор частотного спектра, который может обнаруживать и распознавать сигналы в диапазоне 10 – 20000 Гц. Систему слуха человека можно смоделировать, как 26 пропускающих фильтров, полоса пропускания, которых увеличивается с увеличением частоты. Система слуха человека различает изменения фазы сигнала слабее, нежели изменения амплитуды или частоты.

Аудиосигналы можно разделить на три класса:
- разговор телефонного качества, диапазон 300 – 3400 Гц;
- широкополосная речь 50 – 7000 Гц;
- широкополосные аудиосигналы 20 – 20000 Гц.

Практически все аудиосигналы имеют характерную особенность. Любой из них представляет собой достаточно большой объем данных, для того, чтобы использовать статистические методы внедрения информации

# Лекция 14

## ОБЗОР МЕТОДОВ ЦИФРОВОЙ АУДИО СТЕГАНОГРАФИИ

Основная цель стеганографии - это безопасный обмен данными совершенно незаметным образом, который отрицает сам факт наличия секретных сообщений. Если метод стеганографии вызывает у кого-то подозрения, то такой метод необходимо признать неудачным.

Основная модель аудио стеганографии состоит из носителя (аудио файл), сообщения и пароля.
Под носителем понимается файл, который скрывает или будет скрывать секретную информацию.
Стеганографическая модель изображена на рис.1.

**Сообщение** - это данные, которые отправитель хочет оставить в тайне. В качестве передаваемого сообщения могут выступать простой текст, изображение, аудио и другие типы файлов.
**Пароль** символизирует ключ, зная который, получатель сможет гарантированно декодировать сообщение из файла.
**Файл**-носитель с конфиденциальной информацией называется стегофайлом.

![[Pasted image 20250505162732.png]]
Рисунок 1 - Стеганографическая модель

Процесс сокрытия информации состоит из следующих двух шагов:
- Идентификация избыточных битов в файле-носителе. Избыточными битами называются те биты, которые могут быть модифицированы без порчи качества или нарушения целостности файла-носителя.
- Избыточные биты в файле-носителе заменяются битами секретной информации.

### БАЗОВЫЕ ПОДХОДЫ В АУДИО СТЕГАНОГРАФИИ

Четное кодирование является одним из самых надежных способов аудио стеганографии. Вместо того, чтобы разбивать сигнал в отдельных выборках, этот метод разбивает сигнал на отдельные части и встраивает каждый бит секретного сообщения в четный бит. Если четный бит в выбранной области не подлежит кодированию в секретный бит, то процесс инвертирует младший бит одной из выборки данной области. На рис.2 представлена процедура такого кодирования

![[Pasted image 20250505163445.png]]
Рисунок 2. Четное кодирование

### ФАЗОВОЕ КОДИРОВАНИЕ

Метод фазового кодирования работает путем замены фазы исходного звукового сегмента на опорную фазу, которая представляет собой секретную информацию. Остальные сегменты фазы корректируются для сохранения определенной фазы между сегментами. С точки зрения отношения сигнала к шуму, фазовое кодирование является одним из наиболее эффективных методов кодирования. Когда происходит резкое изменение фазового соотношения между каждой частотной составляющей, шумы становятся заметными. Тем не менее, если фазу модифицировать не сильно, то человеческое ухо не распознает каких-либо изменений. Исходя из этого можно сказать, что этот метод основан на том, что изменения, внесенные в аудиофайл, будут незаметны для человеческого слуха.

Фазовое кодирование включает в себя следующие шаги:
1. Разделить оригинальный звуковой сигнал на более мелкие сегменты таким образом, чтобы их общая длина была равна длине сообщения;
2. Создается матрица фаз с помощью дискретного преобразования Фурье;
3. Вычисляется разность фаз между соседними сегментами;
4. В связи с тем, что фазовые сдвиги между двумя соседними сегментами могут быть легко обнаружены, в стегосигнале должны быть сохранены разности фаз. Поэтому секретное сообщение встраивается только в фазу первого сегмента
5. Используя новую фазу первого сегмента создается новая матрицы фаз и разницы между ними;
6. Звуковой сигнал восстанавливается путем применения обратного дискретного преобразования Фурье с использованием новой матрицы и исходной матрицы величин, после чего звуковые сегменты сцепляются.



Получатель должен знать длину сегмента, чтобы извлечь секретное сообщение из звукового файла. После чего получатель с помощью дискретного преобразования Фурье может извлечь секретную информацию

![[Pasted image 20250505165129.png]]
Рисунок 3. Фазовое кодирование

### МЕТОД РАСШИРЕННОГО СПЕКТРА

В аудио стеганографии метод расширенного спектра пытается передать секретные сведения пс спектру частот звукового сигнала. Этот метод чем-то схож с методом LSB, который передает биты сообщения случайным образом по всему звуковому файлу. Тем не менее, в отличие от способа LSB, метод расширенного спектра распространяет секретную информацию по спектру частот звукового файла, используя код, который не зависит от фактического сигнала. В результате конечный сигнал занимает полосу пропускания, которая размером больше, чем требуемый размер для передачи.

Метод расширенного спектра может внести вклад в повышение производительности по сравнению с методами LSB, фазового и четного кодирований путем умеренной скорости передачи данных и высоким уровнем устойчивости. Однако, метод расширенного спектра имеет один существенный недостаток - он может вносить шум в аудиофайл.

Схема работы метода на рис.4.
(Секретное сообщение -1-> Шифрование -2-> Кодирование сообщения -3-> Модулятор -4-> Чередование носителя сигнала -5-> Квантователь)
![[Pasted image 20250505170109.png]]
Рисунок 4. Схема работы метода расширенного спектра

### ЭХО-МЕТОД

Данный метод встраивает секретную информацию в звуковой файл, вводя эхо в дискретный сигнал. Главные преимущества эхо-метода - это высокая скорость передачи данных, а также повышенная устойчивость по сравнению с другими методами. Если из исходного сигнала можно выделить только одно эхо, то может быть закодирован только один бит секретной информации. Следовательно, перед началом процесса кодирования исходный сигнал разбивается на блоки. После выполнения кодирования блоки объединяются вместе, чтобы образовать окончательный выходной сигнал.

![[Pasted image 20250505170559.png]]
Рисунок 5. Пример работы эхо-метода

Основные недостатки использования таких методов как эхо, расширенного спектра и четности кодирования заключаются в том, что они вносят шум в аудиофайл, который может быть довольно различимым для человеческого уха, а также надежность данных методов вызывает вопросы.

Фазовое кодирование имеет основной недостаток, заключающийся в низкой скорости передачи данных из-за того, что секретное сообщение кодируется только на первом сегменте сигнала. Следовательно, этот метод используется только тогда, когда передается небольшое количество данных.

### Обзор существующих решений в сфере стеганографического сокрытия информации на мобильных устройствах

В настоящее время существуют разные подходы и решения в области стеганографической защиты информации.

При анализе специального программного обеспечения трех наиболее популярных платформ мобильных устройств (iOS, Android), были получены следующие результаты:
- для мобильных iOS-устройств существуют доступных решений ( платные и бесплатны), работающие с графическими стеганографическими контейнерами;
- для устройств, под управление Android, существуют приложения , часть работают с графическими стегоконтейнерами, часть приложений
- с цифровым видео и с аудио- данными. Провести обзор существующих решений для каждой из платформ , описать по 5 приложений с характеристиками для каждой.

**iOS: 5 приложений для стеганографического сокрытия информации**

| Название приложения            | Описание и характеристики                                                                                                                                                                                                                                                                                                  |
| ------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **iWatermark+**                | Позволяет встраивать невидимые стеганографические водяные знаки в фотографии. Поддерживает работу с фото и видео, пакетную обработку, различные типы водяных знаков (текст, QR, подпись и др.), а также наложение метаданных. Предлагает как видимые, так и невидимые способы защиты.                                      |
| **Pictograph - Steganography** | Использует метод изменения наименее значимых битов (LSB) в пикселях изображений для сокрытия текста или других изображений. Поддерживает шифрование AES-256 для дополнительной защиты скрытых данных. Позволяет скрывать сообщения и изображения внутри других изображений, без видимых изменений для человеческого глаза. |
| **Secret Photo Vault**         | Приложение для скрытия фотографий и видео в защищённом хранилище. Помимо обычного скрытия, может использовать стеганографические методы для маскировки наличия защищённого контента (информация из общих знаний, так как прямых упоминаний в поиске нет).                                                                  |
| **Steganography+**             | Позволяет скрывать текстовые сообщения внутри изображений, поддерживает отправку и извлечение скрытых данных через интерфейс приложения. Часто используется для защиты личной информации при передаче.                                                                                                                     |
| **Hide It Pro**                | Многофункциональное приложение для скрытия фото, видео, аудио и заметок. Реализует методы стеганографии для маскировки файлов и защищает доступ паролем или биометрией (описание основано на общих сведениях о подобных приложениях).                                                                                      |

**Android: 5 приложений для стеганографического сокрытия информации**

| Название приложения                               | Описание и характеристики                                                                                                                                                                                                                   |
| ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Steg**                                          | Позволяет скрывать текстовые сообщения в изображениях (метод LSB), поддерживает как шифрование, так и декодирование сообщений. Прост в использовании, подходит для быстрой передачи скрытой информации (описание на основе общих сведений). |
| **Audio Steganography**                           | Приложение для сокрытия текстовых сообщений в аудиофайлах. Использует изменённые аудиосэмплы для внедрения информации без заметных искажений звука (описание на основе общих сведений).                                                     |
| **PixelKnot**                                     | Разработано The Guardian Project. Позволяет скрывать сообщения в фотографиях, используя LSB-метод, с последующей отправкой через мессенджеры и e-mail. Поддерживает шифрование скрываемого сообщения.                                       |
| **Steganography Master**                          | Многофункциональное приложение для сокрытия текста и файлов в изображениях и аудиофайлах. Поддерживает различные алгоритмы стеганографии и шифрования (описание на основе общих сведений).                                                  |
| **Hide Photos, Video and App Lock - Hide it Pro** | Аналогичная версия для Android. Позволяет скрывать фото, видео, заметки и аудио, используя стеганографические методы и защищая доступ паролем или отпечатком пальца (описание на основе общих сведений).                                    |

#### Второй вариант формата

---

## **1. Приложения для iOS**  

### **1.1. Steganography Online**  
- **Описание**: Приложение для скрытия текста в изображениях с использованием LSB-метода (замена младших битов).  
- **Формат контейнера**: JPEG, PNG  
- **Особенности**: Простота использования, поддержка паролей.  
- **Цена**: Бесплатно (с рекламой).  

### **1.2. InSecret**  
- **Описание**: Позволяет прятать текст и небольшие файлы в изображениях.  
- **Формат контейнера**: JPEG, PNG  
- **Особенности**: AES-шифрование, возможность отправки через мессенджеры.  
- **Цена**: Бесплатно (есть платный функционал).  

### **1.3. PixelKnot**  
- **Описание**: Разработано организацией **The Guardian Project**, использует стойкие стеганографические методы.  
- **Формат контейнера**: JPEG, PNG  
- **Особенности**: Поддержка паролей, открытый исходный код.  
- **Цена**: Бесплатно.  

### **1.4. Secret Box - Hide Text in Image**  
- **Описание**: Позволяет скрывать текстовые сообщения в изображениях.  
- **Формат контейнера**: JPEG, PNG  
- **Особенности**: Простое управление, возможность извлечения на других устройствах.  
- **Цена**: Бесплатно.  

### **1.5. Cryptic**  
- **Описание**: Приложение для шифрования и стеганографии, скрывает данные в изображениях.  
- **Формат контейнера**: JPEG, PNG  
- **Особенности**: AES-256 шифрование, поддержка iCloud.  
- **Цена**: Платное (~$2.99).  

---

## **2. Приложения для Android**  

### **2.1. StegApp**  
- **Описание**: Позволяет скрывать текст и файлы в изображениях.  
- **Формат контейнера**: JPEG, PNG  
- **Особенности**: Поддержка шифрования, простой интерфейс.  
- **Цена**: Бесплатно.  

### **2.2. Hide It Pro (Audio Manager)**  
- **Описание**: Маскирует скрытые файлы (изображения, видео, текст) под приложение для настройки звука.  
- **Формат контейнера**: Любые файлы (скрытие в памяти устройства).  
- **Особенности**: Скрытый режим, защита паролем.  
- **Цена**: Бесплатно.  

### **2.3. Steganography Master**  
- **Описание**: Позволяет скрывать текст в изображениях и аудиофайлах.  
- **Формат контейнера**: JPEG, PNG, WAV, MP3  
- **Особенности**: Поддержка нескольких форматов, шифрование.  
- **Цена**: Бесплатно.  

### **2.4. Secret Video Recorder**  
- **Описание**: Приложение для скрытой записи видео, но также поддерживает стеганографию.  
- **Формат контейнера**: MP4, AVI  
- **Особенности**: Запись видео с возможностью скрытия данных.  
- **Цена**: Бесплатно (есть платные функции).  

### **2.5. MobiStego**  
- **Описание**: Специализированное приложение для стеганографии в изображениях.  
- **Формат контейнера**: JPEG, PNG  
- **Особенности**: Открытый исходный код, LSB-метод.  
- **Цена**: Бесплатно.  

---

# Лекция 15
## СКРЫТИЕ ДАННЫХ В ВИДЕОПОСЛЕДОВАТЕЛЬНОСТЯХ

**Стеганография** - это наука сокрытия сообщений таким образом, что никто, кроме предполагаемого получателя, не знает о существовании сообщения.

**Цели**: Конфиденциальность, безопасность связи, защита авторских прав.

Основные компоненты:
- Сообщение: Информация, которую нужно скрыть.
- Контейнер: Невинный объект (изображение, аудио, видео), внутри которого скрывается сообщение.
- Ключ (опционально): Информация, необходимая для извлечения сообщения из контейнера.

**Стеганографический алгоритм**: Метод, используемый для внедрения сообщения в контейнер.

Отличие от криптографии:
- Криптография делает сообщение нечитаемым.
- Стеганография скрывает факт существования сообщения.

Преимущества использования видео в стеганографии:
- **Большой объем**: Видеофайлы обычно имеют большой размер, что позволяет скрывать значительные объемы данных.
- **Подвижность**: Небольшие изменения в видеоряде, вызванные внедрением данных, часто незаметны для человеческого глаза.
- **Широкое распространение**: Видеофайлы широко распространены в Интернете, что делает их идеальным контейнером для скрытия данных.
- **Разнообразие форматов и алгоритмов сжатия**: Существуют различные форматы видео и алгоритмы сжатия, которые можно использовать для скрытия данных.

### Основные методы стеганографии в видео

**Пространственная область** (Spatial domain) - эти методы манипулируют непосредственно пикселями видеокадров.
- **Метод наименее значимых битов (LSB - Least Significant Bit)**: Замена наименее значимых битов пикселей данными сообщения.
  Преимущества: Простота реализации. 
  Недостатки: Относительно низкая устойчивость к сжатию и атакам. Может быть обнаружен с помощью стеганоанализа. 
  Пример: Если бит сообщения равен 1, а наименее значимый бит пикселя равен 0, бит пикселя заменяется на 1. Аналогично для бита 0.
- Pixel Value Differencing (PVD): Использование разницы значений соседних пикселей для скрытия данных.
  Преимущества: Улучшенная устойчивость к сжатию по сравнению с LSB.
  Недостатки: Более сложная реализация

Частотная область (Frequency domain) - эти методы используют преобразования для представления видеокадров в частотной области, где и скрываются данные.

- **DCT (Дискретное косинусное преобразование) Steganography**
  Суть: Модификация DCT-коэффициентов (используемых в алгоритмах сжатия видео, таких как MPEG) для внедрения данных.
  Преимущества: Высокая устойчивость к сжатию и другим типам обработки видео.
  Недостатки: Более сложная реализация и меньшая емкость по сравнению с методами пространственной области. Пример: Небольшие изменения в DCT-коэффициентах, которые меньше всего влияют на качество видео.
- **DWT (Дискретное вейвлет-преобразование) Steganography**
  Суть: Аналогично DCT, но использует вейвлет-преобразования.
  Преимущества: Хорошая устойчивость к различным атакам.
  Недостатки: Сложность реализации.
- **Методы на основе векторов движения (Motion vector-based)**
  Используются в сжатых видеоформатах (например, MPEG). Суть: Модификация векторов движения, используемых для кодирования видео, для внедрения данных.
  Преимущества: Высокая емкость и устойчивость к сжатию.
  Недостатки: Требует понимания алгоритмов сжатия видео.
- **Методы на основе временной области (Temporal domain)**
  Используют временные характеристики видеопоследовательности.
- **Смена кадров (Frame swapping):** Замена некоторых кадров другими (визуально похожими) для внедрения данных.
  Например, последовательность замененных кадров может представлять бинарный код.
- **Синхронизация кадров (Frame synchronization):** Небольшие изменения временных интервалов между кадрами.

**Критерии оценки стеганографических методов**
- **Емкость (Capacity):** объем данных, который можно скрыть в контейнере.
- **Незаметность (Perceptibility):** Насколько трудно обнаружить изменения, внесенные в контейнер. Обычно оценивается субъективно (визуально) или объективно (с использованием метрик качества видео, таких как PSNR - Peak Signal-to-Noise Ratio). Высокий PSNR обычно означает, что изменения незаметны.
- **Устойчивость (Robustness):** Насколько устойчив метод к различным атакам (сжатие, фильтрация, добавление шума, изменение формата).
- **Безопасность (Security):** Насколько трудно извлечь скрытое сообщение без знания ключа.

### Атаки на стеганографию в видео (Стеганоанализ)

- **Визуальный анализ:** Поиск необычных артефактов или паттернов в видео.
- Статистический анализ: Анализ статистических характеристик видео (например, гистограмм, DCT-коэффициентов) для выявления аномалий.
- Специализированные методы стеганоанализа: Методы, разработанные специально для обнаружения определенных стеганографических алгоритмов.

### Применение стеганографии в видео

- Скрытая передача данных: Передача конфиденциальной информации незаметно.
- Защита авторских прав: Внедрение водяных знаков в видео для защиты от несанкционированного копирования.
- Скрытая коммуникация: Использование видео в качестве канала связи для тайных агентов или других лиц, нуждающихся в конфиденциальной связи.
- Цифровая криминалистика: Обнаружение скрытых данных в видеофайлах, используемых в качестве доказательств в уголовных делах.

MPEG - это название экспертной группы ISO, которая работает над созданием стандартов кодирования и сжатия видео- и аудиоданных.

Стеганографические методы, применяемые для встраивания информации в видео, сжатое по стандарту MРЕG-2 (далее - MPEG), должны работать в реальном времени. Способы встраивания ЦВЗ, работающие в реальном времени, должны отвечать нескольким требованиям и, в первую очередь они должны быть слепыми и обладать малой вычислительной сложностью.

![[Pasted image 20250512170428.png]]
Рисунок 1 - Встраивание / извлечение ЦВ3 в развернутые данные и осуществление этой же операции со сжатыми данными

![[Pasted image 20250512171111.png]]
Рис.2. Многоуровневая синтаксическая структура MPEG


Группа кадров видеопотока состоит из компонентов: яркость (Y), цветность (U, V). Кадр представляется формой как YUV, то есть одним каналом яркости и двумя каналам цветности. Изображение в канале яркости - это, по существу, черно-белое изображение. Известно, что зрительная система человека более чувствительна к изменениям в канале яркости, нежели в каналах цветности. Поэтому компоненты U и V могут быть подвергнуты большему сжатию, чем Y.

### Вопросы для самостоятельной работы:
#### 1. Какие преимущества и недостатки у разных методов стеганографии в видео?
**Пространственная область** (Spatial domain) - эти методы манипулируют непосредственно пикселями видеокадров.
- **Метод наименее значимых битов (LSB - Least Significant Bit)**
  Преимущества: Простота реализации. 
  Недостатки: Относительно низкая устойчивость к сжатию и атакам. Может быть обнаружен с помощью стеганоанализа. 
- **Pixel Value Differencing (PVD):** 
  Преимущества: Улучшенная устойчивость к сжатию по сравнению с LSB.
  Недостатки: Более сложная реализация
- **DCT (Дискретное косинусное преобразование) Steganography**
  Преимущества: Высокая устойчивость к сжатию и другим типам обработки видео.
  Недостатки: Более сложная реализация и меньшая емкость по сравнению с методами пространственной области.
- **DWT (Дискретное вейвлет-преобразование) Steganography**
  Преимущества: Хорошая устойчивость к различным атакам.
  Недостатки: Сложность реализации.
- **Методы на основе векторов движения (Motion vector-based)**
  Преимущества: Высокая емкость и устойчивость к сжатию.
  Недостатки: Требует понимания алгоритмов сжатия видео.

#### 2. Как можно улучшить устойчивость стеганографических методов к атакам?
- **Использование комбинированных методов:** Например, сочетание пространственной и частотной областей для повышения устойчивости.
- **Применение криптографии:** Шифрование сообщения перед внедрением усложняет его извлечение без ключа.
- **Оптимизация алгоритмов:** Выбор коэффициентов или областей для внедрения, которые меньше всего влияют на качество видео (например, каналы цветности в YUV).
- **Адаптивные методы:** Внедрение данных в области видео, которые менее подвержены изменениям при сжатии или обработке.
- **Использование избыточности:** Добавление контрольных сумм или кодов коррекции ошибок для защиты данных от искажений.
- **Слепые методы:** Разработка алгоритмов, которые не требуют доступа к исходному контейнеру для извлечения данных, что повышает безопасность.

#### 3. Какие этические вопросы связаны с использованием стеганографии?
- **Незаконная деятельность:** Стеганография может использоваться для скрытой передачи конфиденциальной информации, что может быть связано с преступной или шпионской деятельностью.
- **Нарушение авторских прав:** Внедрение водяных знаков может быть использовано как для защиты авторских прав, так и для их незаконного обхода.
- **Конфиденциальность и слежка:** Использование стеганографии для скрытого наблюдения или сбора данных без согласия пользователей нарушает право на приватность.
- **Ответственность разработчиков:** Создатели стеганографических алгоритмов могут нести моральную ответственность за возможное злоупотребление их технологиями.
- **Этические рамки в исследованиях:** Ученые и разработчики должны учитывать потенциальные риски и последствия своих исследований, особенно в военной или разведывательной сферах.

#### 4. Приведите примеры практического применения стеганографии в видео, которые вы знаете.
Технология Cinavia, разработанная Verance, внедряет неслышимые аудио-водяные знаки в лицензионные Blu-ray диски.

При попытке воспроизвести пиратскую копию плеер (например, Sony PlayStation) обнаруживает водяной знак и автоматически отключает звук.

Фильм "Дюна" (2021) от Warner Bros. содержит Cinavia-метку. Если его скопировать и записать на диск, официальные плееры не будут воспроизводить звук.