``` sql
CREATE TABLE public.sessions (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	movie_id int NOT NULL,
	session_start_date_time timestamp without time zone NULL,
	session_duration time NULL,
	available_seats_number int NULL,
	CONSTRAINT sessions_pk PRIMARY KEY (id),
	CONSTRAINT sessions_fk FOREIGN KEY (movie_id) REFERENCES public.movies(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT
);

ALTER TABLE public.sessions ADD cinema_hall_id int NOT NULL;


ALTER TABLE public.sessions DROP CONSTRAINT sessions_fk;
ALTER TABLE public.sessions ADD CONSTRAINT sessions_fk FOREIGN KEY (movie_id) REFERENCES public.movies(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;
ALTER TABLE public.sessions ADD CONSTRAINT sessions_fk_1 FOREIGN KEY (cinema_hall_id) REFERENCES public.cinema_halls(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;

```

``` sql
CREATE TABLE public.movies (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	movie_title varchar NOT NULL,
	movie_genre varchar NOT NULL,
	director varchar NOT NULL,
	issue_year int NOT NULL,
	description text NULL,
	rating decimal NULL,
	CONSTRAINT newtable_pk PRIMARY KEY (id)
);
```

``` sql
CREATE TABLE public.actors (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	actor_name varchar NOT NULL,
	actor_surname varchar NULL,
	birth_date date NULL,
	country varchar NULL,
	biography text NULL,
	CONSTRAINT actors_pk PRIMARY KEY (id)
);
```

``` sql
CREATE TABLE public.users (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	user_name varchar NOT NULL,
	user_surname varchar NULL,
	email varchar NOT NULL,
	"password" varchar NOT NULL,
	CONSTRAINT users_pk PRIMARY KEY (id)
);
```

``` sql
CREATE TABLE public.reservations (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	user_id int NOT NULL,
	session_id int NOT NULL,
	reserved_seats_number int NULL,
	CONSTRAINT reservations_pk PRIMARY KEY (id)
);

ALTER TABLE public.reservations ADD CONSTRAINT reservations_fk FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;
ALTER TABLE public.reservations ADD CONSTRAINT reservations_fk_1 FOREIGN KEY (session_id) REFERENCES public.sessions(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;

```

``` sql
CREATE TABLE public.reviews (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	user_id int NOT NULL,
	movie_id int NOT NULL,
	movie_rating decimal NOT NULL,
	review_text text NULL,
	CONSTRAINT reviews_pk PRIMARY KEY (id)
);

ALTER TABLE public.reviews ADD CONSTRAINT reviews_fk FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;
ALTER TABLE public.reviews ADD CONSTRAINT reviews_fk_1 FOREIGN KEY (movie_id) REFERENCES public.movies(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;

```

``` sql
CREATE TABLE public.cinema_halls (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	cinema_hall_name varchar NOT NULL,
	seats_number int NOT NULL,
	CONSTRAINT cinema_halls_pk PRIMARY KEY (id)
);
```

``` sql
CREATE TABLE public.movie_pictures (
	id int NOT NULL GENERATED ALWAYS AS IDENTITY,
	movie_id int NOT NULL,
	image_link varchar NULL,
	CONSTRAINT movie_pictures_pk PRIMARY KEY (id)
);

ALTER TABLE public.movie_pictures ADD CONSTRAINT movie_pictures_fk FOREIGN KEY (movie_id) REFERENCES public.movies(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;

```

```sql
CREATE TABLE public.actors_and_movies (
	id int NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	actor_id int NOT NULL,
	movie_id int NOT NULL,
	CONSTRAINT actors_and_movies_pk PRIMARY KEY (id),
	CONSTRAINT actors_and_movies_fk FOREIGN KEY (actor_id) REFERENCES public.actors(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT,
	CONSTRAINT actors_and_movies_fk_1 FOREIGN KEY (movie_id) REFERENCES public.movies(id) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT
);
```


## Запросы по добавлению данных:

### Для таблицы actors

```postgresql
INSERT INTO public.actors
(actor_name, actor_surname, birth_date, country, biography)
VALUES
('Эдвард', 'Нортон', '1969-08-18', 'США', 'Эдвард Нортон - американский актёр, режиссёр, продюсер, сценарист и активист. Лауреат премии «Золотой глобус» и трёхкратный номинант на премию «Оскар».'),

('Брэд', 'Питт', '1963-01-18', 'США', 'Уильям Брэдли Питт - американский актёр и кинопродюсер. Лауреат двух премий «Золотой глобус», двух премий Американской Гильдии киноактёров и двух наград Британской киноакадемии.'),

('Хелена', 'Картер', '1966-06-26', 'Великобритания', 'Хелена Бонем Картер - английская актриса. Лауреат кинопремии BAFTA и международной премии «Эмми», трёхкратная обладательница премии Гильдии киноактёров США, девятикратная номинантка на премию «Золотой глобус», четырёхкратная номинантка на телевизионную премию BAFTA, двукратная номинантка на премию «Оскар».'),

('Джонни', 'Депп', '1963-07-9', 'США', 'Джон Кристофер Депп II - американский актёр, кинорежиссёр, музыкант, сценарист и продюсер. Джонни Депп является обладателем и номинантом многочисленных кинонаград и премий, в том числе и премии «Золотой глобус» в категории «Лучшая мужская роль — комедия или мюзикл» за роль убийцы-цирюльника Суини Тодда в фильме Тима Бёртона «Суини Тодд, демон-парикмахер с Флит-стрит» и премии Гильдии киноактёров США за исполнение роли капитана Джека Воробья в фильме «Пираты Карибского моря: Проклятие Чёрной жемчужины». Трёхкратный номинант на премию «Оскар», девятикратный номинант на премию «Золотой глобус», двукратный номинант на премию BAFTA, номинант на премию «Золотая пальмовая ветвь» Каннского кинофестиваля. Также в послужном списке актёра числятся и четыре номинации на антипремию «Золотая малина».'),

('Джек', 'Николсон', '1937-05-22', 'США', 'Джон Джозеф Николсон - американский актёр, кинорежиссёр, сценарист и продюсер. Николсон считается одним из величайших актёров в истории кино. Он был номинирован на премию «Оскар» рекордные 12 раз, став победителем трижды.'),

('Леонардо', 'Ди Каприо', '1974-11-11', 'США', 'Леонардо Вильгельм Ди Каприо - американский актёр и продюсер. Лауреат многочисленных наград, включая премию «Оскар», BAFTA, премию Гильдии киноактёров США, три премии «Золотой глобус», а также «Серебряного медведя» Берлинского кинофестиваля.'),

('Марк', 'Руффало', '1967-11-22', 'США', 'Марк Алан Руффало - американский актёр, продюсер и активист. Двукратный лауреат премии «Эмми», лауреат премии «Золотой глобус», а также номинант на премии «Оскар», BAFTA, «Грэмми» и «Тони».');
SELECT * FROM actors;
```

Для удаления дублирующихся строк в PostgreSQL можно использовать команду `DELETE` с использованием подзапроса, который выбирает дублирующиеся строки, и оператора `CTID`, который является скрытым идентификатором каждой строки в PostgreSQL. Например, чтобы удалить дублирующиеся строки из таблицы "table_name", можно использовать следующий запрос:
``` sql
DELETE FROM public.actors
WHERE CTID NOT IN (
	SELECT MIN(CTID)
	FROM public.actors
	GROUP BY actor_name
);
```

### Для таблицы movies

``` postgresql
INSERT INTO public.movies
(movie_title, movie_genre, director, issue_year, description, rating)
VALUES
('Бойцовский клуб', 'Драма, Триллер', 'Дэвид Финчер', 2000, 'Терзаемый хронической бессонницей и отчаянно пытающийся вырваться из мучительно скучной жизни клерк встречает некоего Тайлера Дардена, харизматического торговца мылом с извращенной философией. Тайлер уверен, что самосовершенствование — удел слабых, а саморазрушение — единственное, ради чего стоит жить.', 8.7),

('Остров проклятых', 'Драма, Триллер, Детектив', 'Мартин Скорсезе', 2010, 'Два американских судебных пристава отправляются на один из островов в штате Массачусетс, чтобы расследовать исчезновение пациентки клиники для умалишенных преступников. При проведении расследования им придется столкнуться с паутиной лжи, обрушившимся ураганом и смертельным бунтом обитателей клиники.', 9.1),

('Суини Тодд, демон-парикмахер с Флит-стрит', 'Мюзикл, Ужасы, Триллер, Драма', 'Тим Бёртон', 2007, 'Когда-то в Лондоне жил молодой и наивный брадобрей Бенджамин Баркер. Он был женат на прелестной женщине по имени Люси, которая родила ему такую же прелестную дочку. На его беду, прелесть его жены также оценил сластолюбивый судья Терпин — и отправил Бенджамина Баркера на пожизненную каторгу, чтобы без помех овладеть его женой.', 7.7),

('Пираты Карибского моря: Проклятие Черной жемчужины', 'Фэнтези, Боевик, Приключения', 'Гор Вербински', 2003, 'Жизнь харизматичного авантюриста, капитана Джека Воробья, полная увлекательных приключений, резко меняется, когда его заклятый враг — капитан Барбосса — похищает корабль Джека, Черную Жемчужину, а затем нападает на Порт Ройал и крадет прекрасную дочь губернатора, Элизабет Свонн.', 8.4),

('Отступники', 'Триллер, Драма, Криминал', 'Мартин Скорсезе', 2006, 'Два лучших выпускника полицейской академии оказались по разные стороны баррикады: один из них — агент мафии в рядах правоохранительных органов, другой — «крот», внедрённый в мафию. Каждый считает своим долгом обнаружить и уничтожить противника, но постоянная жизнь в искажённых реалиях меняет внутренний мир героев.', 8.5),

('Тёмные воды', 'Драма, Детектив, Биография, История', 'Тодд Хейнс', 2019, 'История корпоративного юриста Роберта Билотта, раскрывшего многолетнюю историю загрязнения окружающей среды химической компанией.', 7.8),

('Сияние', 'Триллер, Драма, Ужасы, Детектив', 'Стэнли Кубрик', 1980, 'Главный герой — Джек Торренс — приехал в элегантный уединенный отель, чтобы поработать смотрителем во время мертвого сезона вместе со своей женой и сыном. Торренс здесь раньше никогда не бывал. Или это не совсем так? Ответ лежит во мраке, сотканном из преступного кошмара.', 7.8);
```

### Для таблицы actors_and_movies

```postgresql
INSERT INTO public.actors_and_movies
(actor_id, movie_id)
VALUES
(2, 1),
(3, 1),
(3, 3),
(4, 3),
(4, 4),
(5, 5),
(5, 7),
(6, 2),
(6, 5),
(7, 2),
(7, 6);
```

### Для таблицы movie_pictures

```postgresql
INSERT INTO public.movie_pictures (movie_id, image_link) VALUES
(1, 'https://kinohod.ru/o/1b/c5/1bc5c3e0-8bd8-4bb2-bb92-79fd50356f61.jpg'),
(2, 'https://kinohod.ru/o/12/e9/12e9fad6-e618-11eb-a401-de9ad328d8a2.jpg'),
(3, 'https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcSmdnOz8Jr-C9h-wEWxdYMtzSVYz2e3mUSRtMGW4AM-20lWS8Uw'),
(4, 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcToqbLoy3cBRIbzhRwRQVIOWBeDuptlG9xPfOAeOBHkdB6M2MA_'),
(5, 'https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcQXnb2Ad9G0JPYCTCkvxs2KbNqmwCuKZe5cbibIWQtGo0zRmkOo'),
(6, 'https://kinohod.ru/o/a8/77/a8778b22-3406-4b99-abc4-aba3d62b94d9.jpg'),
(7, 'https://kinohod.ru/o/9e/6d/9e6d2b64-9eb6-44c7-96c8-a1372227fed8.jpg');
```

### Для таблицы users

```postgresql
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Тайлер', 'Дёрден', 'tyler_durden@mail.com', '123456');
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Роберт', 'Полсен', 'robert_paulsen@mail.com', '654321');
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Марла', 'Сингер', 'marla_singer@mail.com', '123456');
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Венди', 'Торренс', 'wendy_torrance@mail.com', '654321');
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Джек', 'Торренс', 'jack_torrance@mail.com', '123456');
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Роберт', 'Билотт', 'robert_bilott@mail.com', '654321');
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Тедди', 'Дэниэлс', 'teddy_daniels@mail.com', '123456');
INSERT INTO public.users (user_name, user_surname, email, "password") VALUES('Чак', 'Оул', 'chuck_owl@mail.com', '654321');
```

### Для таблицы cinema_halls

```postgresql
INSERT INTO public.cinema_halls (cinema_hall_name, seats_number) VALUES

('Лес Павших Гигантов', 400),

('Огненная Башня Хейда', 340),

('Забытая Крепость', 200),

('Безлюдная Пристань', 150),

('Темнолесье', 210),

('Железная Цитадель', 1000),

('Храм Зимы', 500),

('Замок Дранглик', 480,

('Междумирье', 200),;

UPDATE public.cinema_halls SET cinema_hall_name='Междумирье', seats_number=250 WHERE id=9;
```

### Для таблицы reviews

``` postgresql
INSERT INTO public.reviews (user_id, movie_id, movie_rating, review_text)
VALUES
(1, 2, 7.3, 'Normal'),
(2, 3, 7.8, 'Nice'),
(2, 6, 7.9 'Not bad'),
(4, 4, 8.2, 'Ok'),
(5, 2, 9.0, 'Normal'),
(7, 3, 7.8, 'Ok'),
(7, 1, 8.9, 'Normal');
```

### Для таблицы sessions

``` postgresql
INSERT INTO public.sessions (movie_id, session_start_date_time, session_duration, available_seats_number, cinema_hall_id)
VALUES
(1, '2023-08-07 18:30:00.000', '01:30:00', 54, 5),
(3, '2023-12-07 11:30:00.000', '02:30:00', 28, 3),
(4, '2023-11-07 16:00:00.000', '01:30:00', 4, 7),
(3, '2023-06-07 12:30:00.000', '01:20:00', 104, 1),
(6, '2023-02-07 12:00:00.000', '01:30:00', 64, 2),
(7, '2023-06-07 19:30:00.000', '02:10:00', 560, 6),
(4, '2023-04-07 14:00:00.000', '01:30:00', 14, 4),
(5, '2023-02-07 13:00:00.000', '01:30:00', 0, 9)
;
```

### Для таблицы reservations

``` postgresql
INSERT INTO public.reservations (user_id, session_id, reserved_seats_number) VALUES
(1, 1, 73),
(1, 5, 3),
(2, 3, 13),
(2, 1, 43),
(4, 2, 103),
(5, 6, 993),
(8, 4, 1);
```