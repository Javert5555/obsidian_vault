**Метод Куттера-Джордана-Боссена** - стеганографический метод, осуществляющий внедрение ЦВЗ в изображение. Метод был представлен Мартином Куттером, Фредериком Джорданом и Фрэнком Боссеном в апреле 1998 г., как алгоритм встраивания синего цвета изображения, имеющего RGB-кодирование, поскольку к синему цвету зрительная система человека является наименее чувствительной.

**Метод Куттера-Джордана-Боссена** относится к классу алгоритмов, осуществляющих скрытие данных в пространственной области.

В алгоритмах этого класса внедрение ЦВЗ выполняется за счёт изменения яркостной либо цветовых компонент пикселя.

В этом методе отдельные биты водяного знака многократно внедряются в изображение путём изменения значения синего канала в пикселе. Это изменение пропорционально яркостной компоненте пикселя и может принимать как положительные, так и отрицательные значения в зависимости от значения встраиваемого бита водяного знака.

Основными свойствами, которыми должен обладать ЦВЗ - это неразличимость для человеческого глаза и устойчивость к различным искажениям и изменениям изображения. 

**Метод Куттера-Джордана-Боссена** удовлетворяет первому требованию за счёт встраивания битов водяного знака именно в синий канал пикселя, так как человеческий глаз наименее чувствителен именно к этому цвету.

Устойчивость к искажениям изображения обеспечивается путём многократного встраивания битов ЦВЗ в различных частях исходного изображения.

Применение этого метода показало высокую эффективность при его использовании для защиты авторских прав изображений и видеоматериалов, а также для проверки целостности изображений и QR-кодов.

## ЦВЗ: Основные понятия

**ЦВЗ** - информация, внедренная в цифровой контент (изображение, аудио, видео и т.д.) для защиты авторских прав, аутентификации, отслеживания копий и других целей.

**Встраивание ЦВЗ** — процесс добавления ЦВЗ в контент.

Извлечение ЦВЗ — процесс восстановления ЦВЗ из контента.

**Стойкость** — способность ЦВЗ выдерживать различные виды атак (обработка изображений, сжатие, геометрические преобразования и т.д.) без потери возможности извлечения.  
  
**Невидимость (незаметность)** — степень, в которой ЦВЗ заметен для человеческого восприятия. Идеальный ЦВЗ должен быть невидимым.

## Типы ЦВЗ:
  
**1. Видимые ЦВЗ** — накладываются поверх изображения и видны невооружённым глазом (например, логотип телеканала).

**2. Невидимые ЦВЗ** — встраиваются в изображение таким образом, что они незаметны для человеческого глаза, но могут быть извлечены с помощью специального ПО.

**3. Слепые ЦВЗ** — извлекаются из контента без необходимости использования исходного контента.

**4. Неслепые ЦВЗ** — требуют наличия исходного контента для извлечения ЦВЗ.

## Методы встраивания:

**1. Пространственные методы** — непосредственно изменяют значения пикселей в изображении.

**2. Частотные методы** — преобразуют изображение в частотную область (например, с помощью дискретного косинусного преобразования — DCT) и встраивают ЦВЗ в коэффициенты преобразования.

## Метод Kutter-Jordan-Bossen (KJB)

Общий принцип Метода KJB является пространственным методом встраивания невидимого водяного знака.

Он основан на следующем принципе:
1. Локальная адаптация — вместо того, чтобы встраивать ЦВЗ во все пиксели изображения, метод KJB выбирает только те пиксели, которые имеют достаточную локальную вариацию. Это позволяет минимизировать видимые искажения, вызванные встраиванием ЦВЗ.
2. Анализ локальной статистики — для выбора пикселей, в которые будет встроен ЦВЗ, метод KJB анализирует локальную статистику изображения, в частности, стандартное отклонение значений пикселей в окрестности каждого пикселя.
3. Модификация пикселей — после выбора пикселей, в которые будет встроен ЦВЗ, их значения модифицируются в соответствии с определённым правилом, которое зависит от бита ЦВЗ, который необходимо встроить.

## Алгоритм встраивания метода KJB

Алгоритм встраивания метода состоит из следующих шагов:
  
1. Разбиение изображения на блоки — изображение разбивается на неперекрывающиеся блоки размером N × N пикселей (например, 3×3 или 5×5). Размер блока определяет локальность, в которой оценивается вариация.
2. Вычисление стандартного отклонения — для каждого блока вычисляется стандартное отклонение значений пикселей (обычно яркости или одного из цветовых каналов).
3. Выбор пикселей для встраивания — блоки, стандартное отклонение которых превышает определённый порог T (заранее определённый), считаются пригодными для встраивания ЦВЗ. В каждом таком блоке выбирается один пиксель для встраивания. Часто выбирают пиксель с максимальной яркостью.
4. Встраивание бита ЦВЗ — значение выбранного пикселя модифицируется в соответствии с битом ЦВЗ, который необходимо встроить. Например, если необходимо встроить бит "1", значение пикселя увеличивается на определённую величину α, а если необходимо встроить бит "0", значение пикселя уменьшается на α.

Формула для встраивания:
I'(x, y) = I(x, y) + α * W(i), где:
- I'(x, y) — значение пикселя после встраивания ЦВЗ
- I(x, y) — значение пикселя до встраивания ЦВЗ
- α — сила ЦВЗ (параметр, определяющий степень воздействия на пиксель)
- W(i) — бит ЦВЗ (либо +1, либо -1, для представления 1 и 0 соответственно).
5. Повторение: Шаги 1-4 повторяются для каждого бита ЦВЗ.

## Алгоритм извлечения метода KJB

Состоит из следующих шагов:
1. Разбиение изображения на блоки — изображение разбивается на блоки размером N × N пикселей, как и при встраивании.

2. Вычисление стандартного отклонения — для каждого блока вычисляется стандартное отклонение значений пикселей.

3. Выбор пикселей для извлечения — блоки, стандартное отклонение которых превышает порог T, считаются пригодными для извлечения ЦВЗ. В каждом таком блоке выбирается пиксель, в который, предположительно, был встроен ЦВЗ (например, пиксель с максимальной яркостью).

4. Извлечение бита ЦВЗ — бит ЦВЗ извлекается путём сравнения значения выбранного пикселя с некоторым порогом или с соседними пикселями. В простейшем случае можно сравнить значение пикселя с его исходным значением (если известен исходный контент) или оценить изменение значения относительно соседних пикселей.

Например, можно использовать следующее правило:
W'(i) = sign(I'(x, y) - I(x, y))
где:
- W'(i) — извлечённый бит ЦВЗ.
- sign() — функция, возвращающая +1, если аргумент положительный, и -1, если аргумент отрицательный.
- I′(x, y) — значение пикселя после встраивания ЦВЗ.
- I(x, y) — значение пикселя до встраивания ЦВЗ (требуется для несlepого извлечения).  
 
 Если исходное изображение неизвестно, можно использовать адаптивные методы, основанные на анализе локальных характеристик изображения.  
  
5. Повторение: Шаги 1–4 повторяются для каждого бита ЦВЗ.

## Преимущества и недостатки метода KJB

Преимущества:  
  
1. Относительная простота реализации.

2. Локальная адаптация — выбор пикселей для встраивания на основе локальной статистики позволяет минимизировать видимые искажения.

3. Неплохая стойкость к некоторым атакам (добавление шума, фильтрация и сжатие).

Недостатки:

1. Низкая стойкость к геометрическим атакам (поворот, масштабирование, сдвиг), поскольку метод основан на фиксированном местоположении пикселей.

2. Возможность визуального обнаружения, при достаточно высокой силе ЦВЗ (большом значении α).

3. Требуется оптимизация параметров — для достижения оптимального баланса между стойкостью и невидимостью необходимо тщательно оптимизировать параметры метода, такие как размер блока N, порог T и сила ЦВЗ α.

4. Уязвимость к коллизионным атакам — например, когда злоумышленник пытается встроить свой ЦВЗ поверх оригинального, что может привести к неправильному извлечению оригинального ЦВЗ.

## Модификация и улучшения метода KJB

Существуют различные модификации и улучшения метода KJB, направленные на повышение его стойкости и невидимости. Некоторые из них включают:

1. Использование адаптивного порога T — вместо фиксированного порога T можно использовать адаптивный порог, который зависит от локальных характеристик изображения.

2. Использование более сложных правил встраивания — вместо простого увеличения или уменьшения значения пикселя можно использовать более сложные правила встраивания, основанные на анализе соседних пикселей.

3. Использование частотных преобразований — можно комбинировать метод KJB с частотными преобразованиями, встраивая ЦВЗ в коэффициенты преобразования, выбранные на основе локальной статистики.

4. Синхронизация — для повышения стойкости к геометрическим атакам можно использовать методы синхронизации, которые позволяют восстановить ориентацию и масштаб изображения после геометрических преобразований.

Метод Куттера-Джордана-Боссена (KJB) является классическим и важным методом в области цифровых водяных знаков.  
  
Представляет собой хороший пример пространственного метода, основанного на анализе локальной статистики изображения.  
  
Хотя метод KJB имеет свои недостатки, он послужил основой для разработки многих других более совершенных методов ЦВЗ.  
  
Понимание принципов работы метода KJB является важным для любого специалиста, работающего в области защиты информации и цифровых прав.