В рамках основного лекционного курса изучаются две основные темы: «Анализ программных реализаций» и «Программные закладки». В ходе практических занятий могут быть рассмотрены (на усмотрение преподавателя, ведущего практические занятия по данному курсу) дополнительные темы, например «Защита от копирования» или «Анализ остаточной информации». Вносить в основной лекционный курс эти и другие узкоспециализированные аспекты защиты программ и данных представляется нецелесообразным. Детальное изучение средств и методов анализа программных реализаций целесообразно по следующим причинам. Навыки анализа программных реализаций требуются выпускнику при решении целого ряда практических задач, например:
- экспертиза качества реализации программных и программно-аппаратных средств обеспечения информационной безопасности;
- исследование программного обеспечения на предмет наличия недокументированных возможностей;
- выявление уязвимостей программного обеспечения;
- выявление вредоносного программного обеспечения, оценка опасности обнаруженных вредоносных программ, планирование работ по локализации последствий и пресечению обнаруженной атаки.

Кроме того, владение навыками анализа программных реализаций упрощает отладку собственноручно написанного программного кода и тем самым повышает производительность труда программиста. Программные закладки (в особенности компьютерные вирусы) на сегодняшний день являются одной из наиболее масштабных и опасных угроз информационной безопасности. Трудно представить себе объект информатизации, для которого данная угроза была бы неактуальна. К сожалению, работы по выявлению и уничтожению программных закладок, как правило, сводятся к бездумному применению программных и программно-аппаратных антивирусных комплексов, при этом планирование мероприятий по обеспечению защиты отданной угрозы либо осуществляется чисто формально, либо не осуществляется вообще. В значительной степени это обусловлено недостатком специалистов, обладающих квалификацией, позволяющей эффективно планировать и поддерживать адекватную политику антивирусной защиты компьютеров и компьютерных сетей. Настоящее учебное пособие призвано устранить данный недостаток хотя бы частично.

## 1. Теоретические основы анализа программ

Актуальность задачи анализа программных реализаций алгоритмов защиты обусловливается следующими факторами.
1. Компьютеризация всех областей национальной экономики России. В настоящее время компьютерные технологии активно применяются практически во всех новых областях нашей жизни. Автоматизированные средства обработки информации используются как в высших эшелонах государственной власти и управления, так и в многочисленных предприятиях и организациях, банках и т. п. Практически каждая организациям имеет у себя конфиденциальную информацию, которую надо защищать.
2. Многообразие программных средств обработки информации и используемых в них средств защиты. Средства защиты встраиваются во многие программные продукты самого различного назначения (операционные системы, системы управления базы данных, системы электронного документооборота, разнообразные утилиты и т. п.). При этом подробные технические описания, а также данные независмых экспертиз качества используемой системы защиты далеко не всегда доступны пользователю. В этих условия пользователю информационной системы жизненно важно знать, насколько надежна применяемая им защита.
3. Большой разброс в уровне подготовленности разработчиков. Разработкой систем защиты информации занимаются различные люди и организации, порой разительно отличающиеся по своему научно-техническому потенциалу, уровню подготовки, техническим возможностям. К их числу зачастую относятся любители, т. е. лица, не являющиеся специалистами в области защиты информации. Нельзя исключить с их стороны ошибки при выборе алгоритмов защиты и просто программистские ошибки в процессе разработки программного обеспечения. Хотя сегодня откровенно слабые решения в области защиты информации встречаются гораздо реже, чем 10 — 15 лет назад, они все же встречаются. Одним из последних примеров такого рода, получивших широкую огласку, является система фильтрации информации порнографического характера на «Школьном портале», которая считала поисковый запрос «мокрый снег» непристойным, а целый ряд явно порнографических запросов — вполне допустимыми для школьника.
4. Широкое распространение программных средств зарубежного производства. Среди всех программных средств, применяемых в России в настоящее время, львиную долю составляют программные средства зарубежного производства. В ряде стран, например в США и Франции, имеются ограничения на экспорт стойких систем защиты информации. Бесспорно высокий уровень квалификации подобных разработчиков, удобство эксплуатации информационной системы, сконструированной ведущими зарубежными фирмами, еще не дает гарантии, что информационная система обладает надежной защитой. Кроме того, для программных средств, применяемых в критически важных сегментах информационной инфраструктуры Российской Федерации, весьма важной является задача заблаговременного выявления в используемых программных средствах недокументированных возможностей, которые в случае начала информационной войны могут послужить информационным оружием.
5. Регулярное появление новых версий программных продуктов, которые могут отличаться и средствами защиты. Современные средства обработки информации — чрезвычайно быстро развивающаяся сфера деятельности человека, поэтому проверка надежности средств защиты информационной системы не может рассматриваться как кратковременный эпизод в жизни организации. К этому вопросу приходится возвращаться неоднократно, в связи с чем стоит задача разработки эффективных средств анализа, максимальной автоматизации наиболее трудоемких его этапов.
6. Следует отметить, что описываемую в данной главе методику анализа программ можно применять не только для защиты информации, но и для «нападения» — получения незаконных копий программ, встраивания в программы закладок и вирусов и т. д. Поскольку автор не рассматривает данную книгу как пособие для начинающего хакера, вопросы, связанные с применением методов изучения программ для выполнения подобных незаконных действий, рассматриваться не будут.

Работа по анализу программы включает в себя три основных этапа.
1. Подготовительный этап. На данном этапе аналитик проводит первичное знакомство с анализируемой программой, изучает доступную документацию, планирует дальнейшие исследования, подбирает коллектив и организует его работу. Важность этого этапа нельзя недооценивать. Эффективность дальнейшей работы очень сильно зависит от того, насколько полная информация об анализируемой программе была получена на первом этапе. Если аналитик сумел получить исходный текст анализируемой программы, задача анализа программы в большинстве случаев решается тривиально. Наличие у аналитика отладочной информации об анализируемой программе также существенно упрощает дальнейшую работу.
2. Восстановление алгоритмов функционирования программы. На данном этапе, собственно, и производится изучение программы. Методам, применяемым на этом этапе, посвящена большая часть данной главы.
3. Проверка полученных результатов. На данном этапе аналитик проверяет результаты проведенных исследований. Обычно эта проверка заключается в написании тестовой программы, которая реализует восстановленные алгоритмы анализируемой программы. Если поведение тестовой программы не отличается от поведения анализируемой в отношении анализируемых алгоритмов, задачу можно считать решенной. Если же поведение тестовой программы отличается от поведения анализируемой, это означает, что в анализе программы допущены ошибки, которые необходимо устранить. Как правило, правильно восстановить анализируемые алгоритмы с первого раза не удается.

В настоящее время сформировались следующие подходы к восстановлению алгоритмов, реализуемых программой:
- метод экспериментов;
- статический метод;
- динамический метод.

В методе экспериментов программа рассматривается как «черный ящик», осуществляющий определенные преобразования в зависимости от поступающего на него входа. Аналитик проводит многократные эксперименты, манипулируя входными данными, анализируя и сравнивая получаемые результаты. На основе этих экспериментов он восстанавливает, а точнее, угадывает алгоритмы преобразований.

В статическом методе по файлам программного обеспечения восстанавливаются основные элементы исходной программы, которая затем анализируется с целью получения описания собственно алгоритмов защиты. Основным инструментом статического метода служат программы дизассемблирования, восстанавливающие по исполняемым файлам листинги программы на языке ассемблер. Одним из наиболее удачных дизассемблеров в настоящее время считается пакет IDA.

В динамическом методе анализируемая программа запускается под контролем других специализированных программных средств. Наличие этих средств позволяет прогонять программу в пошаговом режиме, останавливать ее работу при осуществлении тех или иных
событий, что значительно облегчает поиск и анализ фрагментов программы, реализующие преобразования, связанные с защитой информации. Основным инструментом динамического метода являются так называемые программы-отладчики. Вместе с тем могут использоваться и другие программные средства.

# Лекция 2
## Особенности анализа некоторых видов программ
Вопросы:
1. Особенности анализа оверлейных программ
2. Особенности анализа графических программ Windows
3. Анализ параллельного кода
4. Особенности анализа кода в режиме ядра
5. Вспомогательные инструменты анализа программ

### 1. Особенности анализа оверлейных программ
Оверлейные программы размещают на памяти только те фрагменты кода, которые выполняются в данный момент.

Проблемы: точки остановок могут быть потеряны, трудности при использовании метода степ-трейс.

Основное решеник: установка точки останова внутри диспетчера оверлея, в этом случае, при удалении любого из сегментов точки останова при последующей подгрузке, восстанавливаются, при исп метода step-and-trace зацикливания не происходит.

### 2. Особенности анализа графических программ Windows
При исп граф. программ после запуска программы формируется её окно, после чего управление опять передаётся в Windows. Для того чтобы применять метод step-and-trace его необходимо модифицировать:
1. Необходимо найти и выбрать точку входа в программу, в которой осуществляется передача управления в интересующую нас функцию, для этого используется драйвер (Spy++ чащу всего).
2. После того как адрес оконной функции получен в него ставится точка останова, при при этом не следует ставить точку останова в начало, поскольку в этом случае любое сообщение в окно будет приводить к остановке
3. После того, как выполнены первые два, запускаем трассировку
Всё вышеперечисленое относится к обычным, недиалоговым окнам.

В случае диалоговых окон, в начале устанавливается точка останова на системную функцию, с помощью которой создаётся соответствующего диалогового окна
После того как адрес диалоговой функции найден, точка останова устанавливается в эту функцию, дальнейшие действия, как с обычными окнами

### 3. Анализ параллельного кода

При анализе параллельного кода важно удалить все точки остановки, чтобы гарантировать анализ единственного потока программы.

• Отладчики могут ставить временные точки остановки, но это не гарантирует корректной работы.

????????????????????

Для того чтобы решить эту проблему неоходимо в начале трассировки удалить все точки остнанова из анализируемой программы, большинство современных программ трассировки позволяют удалённые точки автоматически восстанавливать, т.е. точка удаляется, а информация об этой точке остаётся в отладчике, в последствие она можжет быть восстановлена и использована.

### 4. Особенности анализа кода в режиме ядра
Для анализа кода в режиме ядра используются специальные системные отладчики, такие как "Сайзер". Важно использовать виртуальные машины для запуска отладчика, чтобы избежать возможных проблем с загрузкой операционной системы. При анализе кода в режиме ядра следует избегать использования инструментов, предназначенных для режима пользователя.

Задачи:
1. Задача возникает, если нам требуется проанализировать работу программы, используя драйверы некоторых физических или логических устройств
2. Когда требуется отследить путь передачи информации от процесса клиента к процессу сервера для анализа кода в этом режиме используются системные отладчики. ядром данного отладчика является драйвер, который перехватывает подавляющее большинство функций ядра windows и предоставляет пользователю практически полный контроль над ОС, при этом используются те же функциональные клавиши, что и остальные программы, отслеживаемые системой и это является существенным достоинством, кроме того, на период передачи управления системному драйверу в ОС, приостанавливается системный таймер, т.е. с точки зрения системы этот период исключается из восприятия системы.

При работе с системными драйверами, надо учитывать следующие факторы:
1. Всегда, когда это возможно, запускать их с виртуальной машины. Это позволяет существенно ускорить процессы перезагрузки системы, которых в режиме анализа ядра будет очень много.
2. Применять системный драйвер для анализа кода выполняемого в пользовательском режиме, нужно в крайнем случае и очень осторожно, а если необходимо анализировать и клиентскую программу и работающую из под ядра целесообразно применять два отладчика одновременно
3. Условные точки останова часто работают некорректно, поэтому на это необходимо уделять больше внимания

### 5. Вспомогательные инструменты анализа программ
Вспомогательные программы - как правило, про-раммы-мониторы, отслеживающие те или иные события, протекающие в ОС, за счёт своей специфичности программы-мониторы позволяют быстрее выделить среди всех потоков интересующих:

1. Монитор активных процессов - Proc.MON, имеет следующий функционал: позволяет регистрировать любые обращения к логическим дискам, почтовым ящикам и сетевым ресурсам, регистрировать порождения и завершения процессов загрузки и выгрузки библиотек и драйверов; интенсивность использования аппаратных ресурсов теми или иными процессами и потоками, при этом используется особый режим регистрации указанных событий (детальное описание, список программных модулей, загруженных в адресное пространство и стэк поток на момент регистрации)
2. ProcessExplorer

# Лекция 3

## Системы защиты программного обеспечения: Обзор

### 1. Классификация систем защиты программного обеспечения
Анализ программной реализации защиты является первым шагом большинства атак на защищённые системы. Разработчики стремятся затруднить этот анализ. Необходимость в системах защиты (СЗ) ПО обусловлена:

*   Незаконным использованием алгоритмов.
*   Несанкционированным использованием ПО.
*   Несанкционированной модификацией ПО.
*   Незаконным распространением ПО.

Существующие системы защиты классифицируются по:

1.  **Методу установки:**
    *   Устанавливаемые на скомпилированные модули ПО: Удобны, но менее стойкие.
    *   Встраиваемые в исходный код ПО до компиляции: Неудобны, но более стойкие.
    *   Комбинированные: Наиболее живучие.
2.  **Используемым механизмам защиты:**
    *   Использующие сложные логические механизмы: Наименее стойкие.
    *   Использующие шифрование защищаемого ПО: Более стойкие.
    *   Комбинированные: Самые стойкие.

### 2. Достоинства и недостатки основных систем защиты

Для защиты ПО используется ряд методов:

1.  **Алгоритмы запутывания:** Внедрение "пустышек", хаотичные переходы.
2.  **Алгоритмы мутации:** Замена операндов-синонимов, случайные изменения структуры.
3.  **Алгоритмы компрессии данных:** Упаковка и распаковка кода.
4.  **Алгоритмы шифрования данных:** Шифрование и расшифровка кода.
5.  **Вычисление сложных математических выражений:** Логика защиты зависит от результата вычислений.
6.  **Методы затруднения дизассемблирования:** Предотвращение дизассемблирования в пакетном режиме.
7.  **Методы затруднения отладки:** Усложнение отладки программы, выявление факта выполнения под отладчиком.

### 3. Показатели эффективности систем защиты

Эффективность защиты ПО определяется стойкостью к анализу и дезактивации. Комбинированные системы, использующие шифрование и сложные логические механизмы, обеспечивают наилучшую защиту.





# **Конспект лекции по системам защиты программного обеспечения**  

---

### **1. Классификация систем защиты программного обеспечения (СЗПО)**  

#### **1.1. По методу установки:**  
1. **На скомпилированные модули:**  
   - Удобны для производителей (защита готового ПО).  
   - Низкая стойкость – злоумышленник может найти точку передачи управления и обойти защиту.  

2. **Встраиваемые в исходный код:**  
   - Высокая стойкость (нет четкой границы между защитой и ПО).  
   - Сложность внедрения (требуется работа с API защиты, усложнение тестирования).  

3. **Комбинированные системы:**  
   - Сочетают преимущества первых двух типов.  
   - Максимально затрудняют анализ и взлом.  

#### **1.2. По используемым механизмам защиты:**  
1. **Сложные логические механизмы:**  
   - Затрудняют дизассемблирование и отладку (внедрение "пустышек", ложных переходов). 
   - Низкая стойкость – логику можно проанализировать и обойти.  

2. **Шифрование защищаемого ПО:**  
   - Более стойкие, требуют определения ключа дешифрации.  
   - Уязвимы к криптоанализу, если алгоритм слабый.  

3. **Комбинированные системы:**  
   - Наиболее эффективны (сочетают логические методы и шифрование).  

---

### **2. Достоинства и недостатки основных систем защиты**  

#### **2.1. Упаковщики/шифраторы**  
✅ **Достоинства:**  
- Высокая защита от анализа алгоритмов.  
- Уменьшение размера исполняемого файла (побочный эффект).  

❌ **Недостатки:**  
- Замедление работы программы.  
- Сложность обновления и исправления ошибок.  
- Повышение требований к аппаратуре.  
- Уязвимость к распаковке/дешифрации.  

#### **2.2. Системы защиты от несанкционированного копирования**  
✅ **Достоинства:**  
- Затрудняют нелегальное копирование.  
- Защищают права легальных пользователей.  

❌ **Недостатки:**  
- Трудоемкость реализации (особенно привязка к уникальным носителям).  
- Замедление продаж (необходимость физической доставки ключей).  
- Конфликты с оборудованием (например, отсутствие нужного порта).  

#### **2.3. Системы защиты от НСД**  
**2.3.1. Парольные защиты**
✅ **Достоинства:**  
- Простота реализации.  
- Минимальные неудобства для пользователя.  

❌ **Недостатки:**  
- Уязвимость к перехвату пароля.  
- Низкая стойкость при наличии доступа к коду проверки.  

**2.3.2. Системы "привязки" ПО**  
✅ **Достоинства:**  
- Не требуют дополнительного оборудования.  
- Затрудняют использование скопированного ПО.  

❌ **Недостатки:**  
- Ложные срабатывания при изменении конфигурации ПК.  
- Низкая стойкость при физическом доступе злоумышленника.  

**2.3.3. Программно-аппаратные средства (электронные ключи)**  
✅ **Достоинства:**  
- Высокая стойкость (особенно ключи с микропроцессором).  
- Защита от нелегального распространения.  

❌ **Недостатки:**  
- Дополнительные затраты на ключи и обучение.  
- Ограничения для ноутбуков (нехватка портов).  
- Возможность кражи ключа.  

---

### **3. Показатели эффективности систем защиты**  

#### **3.1. Показатели применимости**  
- **Технические:** Совместимость с ПО, требования к аппаратуре.  
- **Экономические:** Соотношение затрат на защиту и потенциальных убытков.  
- **Организационные:** Условия распространения, уникальность ПО.  

#### **3.2. Критерии оценки**  
Защита как таковая – затруднение нелегального копирования и доступа, защита от мониторинга, отсутствие логических брешей и ошибок в реализации системы.

Стойкость к исследованию/взлому – применение стандартных механизмов, новые/нестандартные механизмы.

Отказоустойчивость (надежность) – вероятность отказа защиты (НСД), время наработки на отказ, вероятность отказа программы защиты (крах), время наработки на отказ, частота ложных срабатываний.

Независимость от конкретных реализаций ОС – использование недокументированных возможностей, "вирусных" технологий и "дыр" ОС.

Совместимость – отсутствие конфликтов с системным и прикладным ПО, отсутствие конфликтов с существующим АО, максимальная совместимость с разрабатываемым АО и ПО.

Неудобства для конечного пользователя ПО – необходимость и сложность дополнительной настройки системы защиты, доступность документации, доступность информации об обновлении модулей системы защиты из-за ошибок/несовместимости/нестойкости, доступность сервисных пакетов, безопасность сетевой передачи пароля/ключа, задержка из-за физической передачи пароля/ключа, нарушения прав потребителя.

Побочные эффекты – перегрузка трафика, отказ в обслуживании, замедление работы защищаемого ПО и ОС, захват системных ресурсов, перегрузка ОЗУ, нарушение стабильности ОС.

Стоимость – стоимость/эффективность, стоимость/цена защищаемого ПО, стоимость/ликвидированные убытки.

Доброкачественность – доступность результатов независимой экспертизы, доступность информации о побочных эффектах, полная информация о СЗ для конечного пользователя.

![[Pasted image 20250409140538.png]]

--- 

### **Итог**  
- Выбор системы защиты зависит от типа ПО, требований к безопасности и бюджета.  
- Наиболее стойкие методы – комбинированные системы и аппаратные ключи.  
- Важен баланс между защитой, удобством и стоимостью.

# Лекция 4

## Основные моменты лекции

1. **Субъектно-ориентированная модель компьютерной системы**:
   - Компьютерная система рассматривается как множество объектов и субъектов.
   - Субъекты — активные элементы, которые могут изменять состояние объектов.
   - Операция «поток информации» (Stream) описывает взаимодействие между субъектами и объектами.

2. **Программные закладки**:
   - Преднамеренно внесенные функциональные объекты, которые могут реализовать недекларированные возможности.
   - Основная опасность — маскировка своего присутствия в системе.
   - Выявляются из-за неаккуратного использования информации, ошибок в программировании или случайно.

3. **Модели взаимодействия программных закладок с системой**:
   - **Наблюдатель**: закладка инициирует нетипичные информационные потоки.
   - **Перехват**: сохраняет фрагменты информации в скрытых областях.
   - **Искажение**: искажает информационные потоки или инициирует ошибки.

4. **Примеры программных закладок**:
   - Back Orifice и NetBus — средства скрытного удаленного контроля.
   - Используются для несанкционированного управления системой.

5. **Защита от программных закладок**:
   - Использование антивирусных средств и моделей безопасности (например, ДП-модели).

### Основные вопросы

1. **Описание субъектно-ориентированной модели компьютерной системы**:
   - Какие ключевые элементы включает эта модель?
   - Как определяются субъекты и объекты в системе?

2. **Модели взаимодействия программных закладок с атакуемой системой**:
   - Какие основные модели взаимодействия существуют?
   - Какие функции выполняют программные закладки в каждой модели?

3. **Принципы выявления и защиты от программных закладок**:
   - Как программные закладки обычно выявляются?
   - Какие меры защиты можно использовать для предотвращения их воздействия?

4. **Примеры программных закладок и их применение**:
   - Какие известные программные закладки существуют?
   - Как они используются в практике для несанкционированного доступа?

### 1. Описание субъектно-ориентированной модели компьютерной системы

Субъектно-ориентированная модель компьютерной системы рассматривает систему как множество объектов и субъектов. **Субъекты** — это активные элементы, которые могут изменять состояние объектов. **Объекты** — это пассивные элементы, которые могут быть изменены субъектами. В этой модели определены две ключевые операции: **поток информации (Stream)** и **ассоциирование**.

- **Поток информации (Stream)**: Эта операция описывает взаимодействие между субъектами и объектами. Она позволяет субъекту изменить состояние объектов, используя текущее состояние других объектов. Операция Stream может создавать или удалять объекты.
  
- **Ассоциирование**: Объект считается ассоциированным с субъектом, если его содержимое влияет на состояние субъекта. Каждый субъект ассоциирован сам с собой.

### 2. Модели взаимодействия программной закладки с атакуемой системой

Программные закладки взаимодействуют с атакуемой системой через несколько моделей:

1. **Модель «Наблюдатель»**:
   - Программная закладка инициирует нетипичные информационные потоки или моделирует сбойные ситуации.
   - Часто используется для скрытного удаленного контроля, например, с помощью Back Orifice и NetBus.
   - Эти закладки позволяют управлять файловой системой, конфигурацией и процессами.

2. **Модель «Перехват»**:
   - Закладка сохраняет фрагменты информации в скрытых областях.
   - Может перехватывать клавиатурный ввод или сохранять пароли.

3. **Модель «Искажение»**:
   - Закладка искажает информационные потоки или инициирует ошибки.
   - Может подавлять или вызывать ошибки в системе.

Эти модели позволяют закладкам маскировать свое присутствие и выполнять несанкционированные действия в системе.




# Конспект лекции по субъектно-ориентированной модели компьютерной системы и моделям взаимодействия программных закладок

---

#### **1. Описание субъектно-ориентированной модели компьютерной системы**

- **Основные понятия:**
  - **Компьютерная система** представляется как множество объектов \(\{O_i\}\), среди которых выделяются **субъекты** \(\{S_i\}\) — активные элементы (например, процессы).
  - **Субъекты** обладают свойством активности ("получать управление"), тогда как объекты (например, файлы) пассивны.
  - **Операции:**
    1. **Поток информации (Stream):** Действие, при котором субъект \(S\) изменяет состояние объектов-приемников, используя объекты-источники. Может включать создание или удаление объектов.
    2. **Порождение субъекта (Create):** Создание нового субъекта из объекта под воздействием другого субъекта.
    3. **Ассоциирование:** Объект \(O\) ассоциирован с субъектом \(S\), если \(S\) использует информацию из \(O\).

- **Доступ и безопасность:**
  - **Доступ** — применение субъектом операции _Stream_ к объекту (чтение, запись, создание, удаление).
  - Доступы делятся на:
    1. **Санкционированные (\(L\))** — разрешенные.
    2. **Несанкционированные (\(N\))** — запрещенные.
  - **Монитор безопасности (\(M\))** — специальный субъект, проверяющий соответствие доступа множеству \(L\). При нарушении доступ блокируется.

- **Несанкционированный доступ (НСД):**
  - Возникает из-за:
    1. Ошибок в мониторе \(M\).
    2. Некорректного описания \(L\) (неадекватная политика безопасности).
  - **Опосредованный НСД:** Автономные действия субъектов (программных закладок), изменяющих объекты или политику безопасности для последующего НСД.

- **Программные закладки:**
  - Определяются как функциональные объекты, реализующие недекларированные возможности.
  - Могут быть **простыми** (один субъект) или **составными** (несколько взаимодействующих субъектов, включая основную и инсталлирующую части).
  - Основная опасность: способность маскировать своё присутствие в системе.

---

#### **2. Модели взаимодействия программной закладки с атакуемой системой**

Выделяются три основные модели:

1. **Модель «Наблюдатель»**:
   - Закладка внедряется как автономный субъект, реагирующий на активизирующие события.
   - **Примеры функций:**
     - Удалённое управление файловой системой, процессами, конфигурацией.
     - Скрытие присутствия (например, Back Orifice, NetBus).
   - **Особенности:**
     - Часто использует модульную архитектуру (ядро + динамически подгружаемые библиотеки).
     - Маскировка под легитимные протоколы (HTTP, SMTP, ICQ).
     - Недостатки: уязвимость к антивирусам, большой размер серверной части.

2. **Модель «Перехват»**:
   - Закладка дублирует или сохраняет информацию из целевых потоков.
   - **Типы перехватчиков:**
     - **Клавиатурные фильтры:** Перехват паролей (1-й род — имитация входа, 2-й род — фильтрация ввода, 3-й род — замещение аутентификации).
     - **Мониторы файловых систем:** Перехват критичных файлов (пароли, журналы аудита).
     - **Мониторы сети:** Перехват сетевого трафика (аутентификационные пакеты, ключевые слова).
   - **Особенности:** Избирательность перехвата для минимизации нагрузки.

3. **Модель «Искажение»**:
   - Закладка модифицирует информационные потоки или политику безопасности.
   - **Основные методы:**
     - Несанкционированное повышение полномочий (например, через SUID/SGID в UNIX, олицетворение в Windows).
     - Модификация кода монитора безопасности.
     - **Стелс-технологии:** Сокрытие файлов, процессов, портов (например, перехват системных вызовов в режиме ядра).
   - **Примеры:** Подмена политики безопасности, скрытие активности закладки.

---

#### **Итоговая классификация моделей взаимодействия** (Рис. 2 в лекции):
- **Наблюдатель:** Удалённый контроль.
- **Перехват:** Копирование критичных данных.
- **Искажение:** Изменение данных или политик безопасности.

**Ключевые выводы:**
- Программные закладки используют слабые места в разграничении доступа и мониторинге.
- Для защиты важно контролировать целостность ПО, политики безопасности и использовать методы обнаружения аномалий.

# Лекция 5

## Основные моменты лекции

### **1. Предпосылки к внедрению программных закладок**

Внедрение программных закладок в защищённые компьютерные системы возможно только при наличии определённых условий, которые связаны с уязвимостями системы или ошибками в её защите. Основные предпосылки включают:

- **Ошибки администраторов**:
  - Даже высококвалифицированные администраторы могут допустить случайные ошибки, временно нарушающие политику безопасности, что позволяет внедрить закладку.
  
- **Уязвимости программного обеспечения**:
  - Современное ПО, включая средства защиты информации, часто содержит ошибки, которые могут быть использованы злоумышленниками.
  - Программные закладки чаще всего внедряются через эксплойты — код или команды, использующие уязвимости ПО.

- **Ключевые условия для успешного внедрения**:
  - Наличие информационных потоков, которые не блокируются системой безопасности.
  - Некорректная работа монитора безопасности, который не блокирует несанкционированные потоки.

Практика показывает, что абсолютная защита от программных закладок практически недостижима из-за человеческого фактора и несовершенства программного обеспечения.

---

### **2. Методы внедрения программных закладок**

Методы внедрения программных закладок основываются на использовании уязвимостей системы. Основные подходы включают:

#### **Эксплуатация уязвимостей ПО**
Наиболее распространённый метод — использование эксплойтов для атак на уязвимые системы. Типичные уязвимости:
- **Переполнения буферов**:
  - Возникают при недостаточной длине буфера или некорректной проверке входных данных.
  - Пример: переполнение в Microsoft Internet Explorer или Windows XP при обработке сетевых запросов по протоколу RPC.
- **Отсутствие проверок входных данных**:
  - Нарушители могут передать некорректные данные, что приводит к сбоям или нарушению политики безопасности.
  - Пример: эксплойт GetAdmin для Windows NT позволял повышать привилегии пользователя.

#### **Типичные эксплойты**
- **RPC DCOM Exploit**:
  - Используется для атак на однотипные системы.
- **Уязвимость %00 (нулевой байт)**:
  - Позволяет запускать исполняемые файлы через веб-браузеры (например, Internet Explorer).

#### **Противодействие методам внедрения**
Для предотвращения использования уязвимостей применяются следующие меры:
- Системы обнаружения вторжений (СОВ), блокирующие подозрительные данные.
- Защита стека вызовов и использование безопасных библиотек.
- Механизмы DEP (Data Execution Prevention) и ASLR (Address Space Layout Randomization), ограничивающие возможности злоумышленников.

Эти методы позволяют значительно снизить вероятность успешного внедрения программных закладок, хотя полностью исключить их невозможно.
# Лекция 6
## Средства и методы защиты от программ закладок
1. Методы защиты от программ закладок
2. Сканирование системы на предмет наличия программ закладок
3. Контроль целостности ПО
4. Контроль целостности конфигурации защищаемой системы
5. Антивирусный мониторинг информационных процессов
6. Создание ловушек.

### 1. Методы защиты от программ закладок

Все методы защиты делятся на 2 группы:
1. Методы, основанные на применении штатных средств
2. Методы, основанные на применении специализированных средств для выявления, предупреждения и пресечения разрушительных воздействий программ закладок.

Политика безопасности комп. систем в отношении встраиваемых закладок базирующихся на 2 основных принципах:
1. Минимизация используемого ПО
2. Минимизация полномочий/привилегий пользователя - заключается в использовании изолированной программной среды, чем сложнее правила доступа, тем сложнее их использовать

>[!info]
>**Изолированная программная среда** — это специально созданное окружение, в котором программы выполняются отдельно от основной операционной системы и других приложений. Такая изоляция позволяет:  
>
> - **Запускать программы без влияния на основную систему** (например, тестировать вредоносное ПО или нестабильное ПО).  
>- **Использовать разные версии библиотек и зависимостей** без конфликтов (например, Python 2 и Python 3 на одном компьютере).  
>- **Ограничивать доступ к ресурсам** (файлам, сети, устройствам) для повышения безопасности.  
>Примеры изолированных сред:  
>1. **Виртуальные машины (VM)** – полная изоляция ОС (VirtualBox, VMware).  
>2. **Контейнеры** (Docker, LXC) – изоляция процессов с общим ядром ОС.  
>3. **Песочницы (Sandbox)** – ограниченная среда для запуска ненадёжного кода (например, браузерные песочницы, Firejail).  
>4. **Виртуальные окружения (Python venv, Node.js npm)** – изоляция зависимостей для разработки.  

Изолированные среды широко используются в разработке, тестировании и кибербезопасности.

#### Средства защиты
Не смотря на существующие адекватные политики безопасности, поддерживать их в течение длительного времени неукоснительным соблюдением достаточно сложно (почти невозможно), по этой причине необходимо и используется доп. средства защиты 

Основные требования к средствам защиты:
**1.** Общие требования:
1) эффективность;
2) надёжность;
3) простота реализации;
4) простота администрирования

**2.** Требования к средствам защиты:
1) Сохранность эксплуатационных качеств системы - защита системы не должна вносить изменения в свойства эксплуатационной системы
2) Противодействие активным воздействия программ закладок
3) Эшелонированность - свойства защитной системы должны сохраняться при выходе её элементов из строй (сохранность свойств, при значительных изменениях состояния элементов)

### 2. Сканирование системы на предмет наличия программ закладок

При сканировании систем используется 2 метода:
1. Сигнатурный – поиск вредоносных программ по известным шаблонам (сигнатурам) в коде или структуре файлов. Недостаток - надо пополнять постоянно пополнять базу сигнатур. Варианты: проверка всей системы или проверка на лету.
2. Эвристический – анализ поведения и характеристик программ для выявления подозрительной активности, даже если точная сигнатура неизвестна. (Для работы программ закладок, как правило исп. специфические виды написания кодов, и их можно эвристически вычислить)

### 3. Контроль целостности ПО
Данный метод заключается в следующем на моменте создания ПО осуществляется подсчёт КС и определяется размер файла, он кодируется защищённым кодом, подписывается и хранится в спец. файле. Периодически происходит проверка сумм.

В связи с тем, что изменения программ и обновления, нам приходится часто осуществлять проверки КС. Сканируем либо всё целиком либо, только используемый ПП.

### 4. Контроль целостности конфигурации защищаемой системы

Данный метод основан на следующем: для всех переменных конфигурации защищаемой системы, которые могут быть изменены с помощью программ закладок, создаются эталонные копии и периодически эти эталонные копии сравниваются с элементами конфигурации.

Любые виды изменений в системе ведёт к изменении конфигурации => необходимо создание новых эталонных копий, кроме того для всех элементов конфигурации нужно проверять не появились ли новые элементы конфигурации системы.

### 5. Антивирусный мониторинг информационных процессов (потоков)

Данный метод основан на том, что любая программа закладка так или иначе вмешивается в информационные потоки. Эти вмешательства могут быть обнаружены с помощью соответствующих мониторов.

Наиболее эффективен мониторинг в тех инф. потоках, которые наиболее часто связаны с применением программ закладок:
1. Потоки, связанные с паролями пользователей
2. Потоки, связанные с обращениями к файловой системе
3. Потоки, связанные с обращениями к сетевым ресурсам

### 6. Создание ловушек.

Данный метод заключается в создании в защищённой системе, заманчивых для нарушителей объектов, доступ к которым не возможен без использования программ-закладок, при этом осуществляется контроль всех успешных обращений к данному объекту и если обращение было от нелигитимного пользователя, то это скорее всего действие программы-закладки.