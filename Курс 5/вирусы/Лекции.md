# Лекция 1
## Классификация вирусов

1. Вводные замечания.
2. Вредоносные программы:
	- вирусы;
	- черви;
	- трояны.
1. Ущерб от вредоносных программ.
2. Угрозы безопасности информации.

Зачем нужно проводить классификацию изучаемых объектов?
Почему задача обнаружения вирусов неразрешима?

Поскольку теоретическая задача обнаружения вирусов неразрешима, на практике приходится решать частные задачи по борьбе с частными случаями вредоносных программ. 
В зависимости от характерных свойств вирусов для их обнаружения и нейтрализации могут применяться различные методы. В связи с этим возникает вопрос о классификации вредоносных программ, чему и посвящена эта лекция. Необходимо отметить, что на практике, классификации, принятые различными производителями антивирусных продуктов, отличаются, хотя и построены на близких принципах. Поэтому в ходе изложения будут формулироваться в первую очередь принципы, и уже потом примеры из классификации, используемой в Лаборатории Касперского.

Отметим что, определение компьютерного вируса - исторически проблемный вопрос, поскольку достаточно сложно дать четкое определение вируса, очертив при этом свойства, присущие только вирусам и не касающиеся других программных систем. Наоборот, давая жесткое определение вируса как программы, обладающей определенными свойствами, практически сразу же можно найти пример вируса, таковыми свойствами не обладающего.

Определение по ГОСТ Р 51188-98: _**Вирус** — программа, способная создавать свои копии (необязательно совпадающие с оригиналом) и внедрять их в файлы, системные области компьютера, компьютерных сетей, а также осуществлять иные деструктивные действия. При этом копии сохраняют способность дальнейшего распространения Компьютерный вирус относится к вредоносным программам_.

Оно в большой степени повторяют определение Ф. Коэна, из чего следует вывод о невозможности создать алгоритмы, обнаруживающий ВСЕ такие программы или даже все  
"инкарнации" одного из вирусов. Тем не менее, на практике оказывается, что все известные вирусы могут быть обнаружены антивирусными программами. Результат достигается за счет того, что поврежденные или неудачные экземпляры вирусов, неспособные к созданию и внедрению своих копий, обнаруживаются и классифицируются наравне со всеми остальными "полноценными" вирусами. Следовательно, с практической точки зрения, т. е., с точки зрения алгоритмов поиска, способность к размножению во не является обязательной для причисления программы к вирусам.

Другая проблема, связанная с определением компьютерного вируса кроется в том, что сегодня под вирусом чаще всего понимается не "традиционный" вирус, а практически любая вредоносная программа. Это приводит к путанице в терминологии, осложненной еще и тем, что практически все современные антивирусы способны выявлять указанные типы вредоносных программ, таким образом ассоциация "вредоносная программа-вирус" становится все более устойчивой. Исходя из этого, а также из назначения антивирусных средств. в дальнейшем, если это не будет оговорено отдельно, под вирусами будут подразумеваться именно вредоносные программы.

Вредоносная программа — компьютерная программа или переносной код, предназначенный для реализации угроз информации, хранящейся в КС, либо для скрытого нецелевого использования ресурсов КС, либо иного воздействия, препятствующего нормальному функционированию КС. К вредоносным программам относятся компьютерные вирусы, трояны, сетевые черви и др. Компьютерные вирусы, трояны и черви являются основными типами вредоносных программ.
## ВИРУСЫ Жизненный цикл вируса
отличительной особенностью вирусов  является способность к размножению, деление вирусов на тишь происходит в соответствии со способами размножения.  
Сам процесс размножения может быть условно разделен на несколько стадий:
1. Проникновение на компьютер
2. Активация вируса
3. Поиск объекта для заражения
4. Внедрение вирусных копий

Особенности реализации, которых порождают атрибуты которые определяют класс вируса
### Проникновение на компьютер

Вирусы проникают на компьютер вместе с зараженными файлами или другими объектами. Следовательно, целесообразно различать **вирусы-паразиты** (или просто вирусы) размножаются с использованием ресурсов, принадлежащих другим программам. Например, внедряются внутрь этих программ и активируются они внедряются внутрь этих программ и активируются вместе с их запуском.

Вирусы-черви (или просто черви), используют только ресурсы вычислительных систем (оперативную и долговременную память, непрограммные файлы), рассылая свои копии по сетям, раскладывая их по носителям информации, буферам памяти, чужим архивам и т.п. Черви автономны, к другим программам они не прикрепляются.

Для активации вируса необходимо, чтобы зараженный объек получил управление. Здесь деление вирусов происходит по типам объектов, которые могут быть заражены:  
1. Загрузочные - вирусы, заражающие загрузочные сектора постоянных и сменных носителей. пример. Virus.Boot.Snows записывает свой код в MBR жесткого диска или в загрузочные сектора При этом оригинальные загрузочные сектора шифруются вирусом. После получения управления, вирус остается в памяти и перехватывает прерывания.
2. Файловый - вирусы, заражающие файлы. Эта груш дополнительно делится на: собственно файловый - те которые непосредственно работают с ресурсами ОС. (Самый известный файловый — Virus, Win9x.CIH.)
3. Макровирусы — вирусы, написанные на языке макрокоманд и исполняемые в среде какого-либо приложения. В подавляющем большинстве случаев речь идет о макросах в документах Microsoft Office. Одними из наиболее разрушительных макровирусов являются представители семейства Macro.Word97.Thus. Эти вирусы содержат три процедуры Document_Open, Document_Close и Document_New, которыми подменяет стандартные макросы, выполняющиеся при открытии, закрытии и создании документа, тем самым обеспечивая заражение других документов.
4. Скрипт-вирусы — вирусы, исполняемые в среде определенной командной оболочки: раньше - bat-файлы в командной оболочке DOS, сейчас чаще VBS и JS - скрипты в командной оболочке Windows Scripting Host (WSH). Virus.VBS.Sling написан на языке VBScript (Visual Basic Script). При запуске он ищет файлы с расширениями .VBS или .VBE и заражает их.

Virus.WinHLP.Pluma.a - вирус, заражающий файлы помощи Windows. При открытии зараженного файла помощи выполняется вирусный скрипт, который используя нетривиальный метод (по сути, уязвимость в обработке скриптов) запускает на выполнение уже как обычный файл Windows определенную строку кода, содержащеюся в скрипте. Запущенный код производит поиск файлов справки на диске и внедряет в их область System скрипт автозапуска.

В эпоху вирусов для DOS часто встречались гибридные файлово-загрузочные вирусы. После массового перехода на операционные системы семейства Windows практически исчезли как сами загрузочные вирусы, так и упомянутые гибриды.

Отдельно стоит отметить тот факт, что вирусы, рассчитанные для работы в среде определенной ОС или приложения, оказываются неработоспособными в среде других ОС и приложений.

## Стадия поиска объектов для заражения

На стадии поиска объектов для заражения встречается два способа поведения вирусов.

1. Получив управление, вирус производит разовый поиск жертв, после чего передает управление ассоциированному с ним объекту (зараженному объекту). Обычно при освоении новой платформы сначала появляются вирусы именно этого типа.
2. Получив управление, вирус так или иначе остается в памяти и производит поиск жертв непрерывно, до завершения работы среды, в которой он выполняется во времена однозадачной DOS было принято называть **резидентными**. С переходом на Windows проблема остаться в памяти перестала быть актуальной: практически все вирусы, исполняемые в среде Windows, равно как и в среде приложений MS Office, являются вирусами второго типа. И напротив, _скрипт-вирусы являются вирусами первого типа_. Соответственно, атрибут резидентный применим только к файловым DOS вирусам. Существование нерезидентных Windows вирусов возможно, но на практике они являются редким исключением.

Отдельно имеет смысл рассмотреть так называемые stealth-вирусы - вирусы, которые находясь постоянно в памяти, перехватывают обращения к зараженному файлу и на ходу удаляют из него вирусный код, передавая в ответ на запрос неизмененную версию файла. Таким образом эти вирусы маскируют свое присутствие в системе. Для их обнаружения антивирусным средствам требуется возможность прямого обращения к диску в обход средств операционной системы. Наибольшее распространение Stealth-вирусы получили во времена DOS.

## Подготовка вирусных копий

**Процесс подготовки копий для распространения** может существенно отличаться от простого копирования. Авторы наиболее сложных в технологическом плане вирусов стараются сделать разные копии максимально непохожими для усложнения их обнаружения антивирусными средствами. Как следствие, составление сигнатуры для такого вируса крайне затруднено либо вовсе невозможно.

Сигнатура вируса — в широком смысле, информация, позволяющая однозначно определить наличие данного вируса в файле или ином коде. Примерами сигнатур являются: уникальная последовательность байт, присутствующая в данном вирусе и не встречающаяся в других программах; контрольная сумма такой последовательности.

При создании копий для маскировки могут применяться следующие технологии:
- **Шифрование** — вирус состоит из двух функциональных кусков: собственно вирус и шифратор. Каждая копия вируса состоит из шифратора, случайного ключа и собственно вируса, зашифрованного этим ключом.
- **Метаморфизм** — создание различных копий вируса путем замены блоков команд на эквивалентные, перестановки местами кусков кода, вставки между значащими кусками кода "мусорных" команд, которые практически ничего не делают.

Сочетание этих двух технологий приводит к появлению следующих типов вирусов.
- Шифрованный вирус — вирус, использующий простое шифрование со случайным ключом и неизменный шифратор. Такие вирусы легко обнаруживаются по сигнатуре шифратора.
- Метаморфный вирус — вирус, применяющий метаморфизм ко всему своему телу для создания новых копий.
- Полиморфный вирус — вирус, использующий метаморфный шифратор для шифрования основного тела вируса со случайным ключом. При этом часть информации, используемой для получения новых копий шифратора также может быть зашифрована. Например, вирус может реализовывать несколько алгоритмов шифрования и при создании новой копии менять не только команды шифратора, но и сам алгоритм. Пик популярности полиморфных вирусов пришелся на времена DOS, тем не менее, и позднее полиморфизм использовался во множестве вирусов, продолжает использоваться полиморфизм и сегодня.

## Внедрение

Внедрение вирусных копий может осуществляться двумя принципиально разными методами:

- Внедрение вирусного кода непосредственно в заражаемый объект
- Замена объекта на вирусную копию. Замещаемый объект, как правило, переименовывается

Для вирусов характерным является преимущественно первый метод. Второй метод намного чаще используется червями и троянами, а точнее троянскими компонентами червей, поскольку трояны сами по себе не распространяются.

**Пример**. Один из немногих почтовых червей, распространяющихся по почтовой книге The Bat! - Email-Worm.Win32.Stator.a, помимо всего прочего заражает некоторые файлы Windows по принципу вируса-компаньона. В частности, к заражаемым файлам относятся: mplayer.exe, winhlp32.exe, notepad.exe, control.exe, scanregw.exe.

# Лекция 2 Классификация вирусов
1. Вводные замечания
2. Вредоносные программы вирусы черви трояны
3. Ущерб от вредоносных программ
4. Угрозы безопасности информации

- Зачем нужно проводить классификацию изучаемых объектов?
- Почему задача обнаружения вирусов неразрешима?

Поскольку теоретическая задача обнаружения вирусов неразрешима, на практике приходится решать частные задачи по борьбе с частными случаями вредоносных программ. В зависимости от характерных свойств вирусов для их обнаружения и нейтрализации могут применяться различные методы. В связи с этим возникает вопрос о классификации вредоносных программ, чему и посвящена эта лекция. Необходимо отметить, что на практике классификации. принятые различными производителями антивирусных продуктов, отличаются, хотя и построены на близких принципах. Поэтому в ходе изложения будут формулироваться в первую очередь принципы, и уже потом примеры из классификации, используемой в Лаборатории Касперского.

Отметим что, определение компьютерного вируса - исторически проблемный вопрос, поскольку достаточно сложно дать четкое определение вируса, очертив при этом свойства, присущие только вирусам и не касающиеся других программных систем. Наоборот, давая жесткое определение вируса как программы, обладающей определенными свойствами, практически сразу же можно найти пример вируса, таковыми свойствами не обладающего. Определение по ГОСТ Р 51188-98: Вирус — программа, способная создавать свои копии (необязательно совпадающие с оригиналом) и внедрять их в файлы, системные области компьютера, компьютерных сетей а также осуществлять иные деструктивные действия. При этом копии сохраняют способность дальнейшего распространения Компьютерный вирус относится к вредоносным программам.


# Лекции 5
## Распространение вредоносных программ


# Лекция 6
## Распростарнение почтовых червей


# Лекция 7
## Обнаружения вирусов


# Лекция 8
## Оптимизация сигнатурного поиска
Если расхождений не обнаружено, значит, образец в наборе найден. В противном случае (то есть если в какой- нибудь букве расхождение все-таки возникло) возможны две принципиально различные ситуации. Первая ситуация возникает, когда в образце уже имеются буквы, равные той, которая в этот момент находится напротив «хвоста» образца (например, несколько букв «Л» как на первом шаге поиска, или несколько «О», как на третьем шаге). В этом случае необходимо сдвигать образец таким образом, чтобы буквы файла и сигнатуры оказались напротив (см шаг 1 буква «Л») Вторая ситуация соответствует случаю, когда такая буква не встречается в образце. Следовательно, можно смело сдвигать образец на полную его длину - на 3 элемента (см. ситуацию на втором шаге сравнения).

